<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="robots" content="noindex,noarchive">
	<meta name="generator" content="Nette Tester">

	<title>Code coverage</title>

	<style type="text/css">
	html {
		font: 16px/1.5 sans-serif;
		border-top: 4.7em solid #F4EBDB;
	}

	body {
		max-width: 990px;
		margin: -4.7em auto 0;
		background: white;
		color: #333;
	}

	h1 {
		font-size: 1.9em;
		margin: .5em 0 1.5em;
		color: #7A7772;
		text-shadow: 1px 1px 0 white;
	}

	div.code {
		font: 14px/1.2 Consolas, monospace;
		background: #FDF5CE;
		padding: .4em .7em;
		border: 1px dotted silver;
		overflow-x: auto;
		display: none;
	}

	span.line {
		color: #9F9C7F;
		font-weight: normal;
		font-style: normal;
	}

	.t {
		background: #99f999;
	}

	.u {
		background: #f9ac9e;
	}

	td {
		vertical-align: middle;
	}

	small {
		color: gray;
	}

	.number {
		text-align: right;
		width: 50px;
	}

	.bar {
		border: 1px solid #ACACAC;
		background: #e50400;
		width: 35px;
		height: 1em;
	}

	.bar div {
		background: #1A7E1E;
		height: 1em;
	}

	.light td {
		opacity: .5;
	}

	.light td * {
		color: gray;
	}

	.not-loaded td * {
		color: red;
	}
	</style>
</head>

<body>
	<h1>Code coverage 82&nbsp;%</h1>

		<div>
		<table>
		<tr>
			<td class="number"><small>100 %</small></td>
			<td><div class="bar"><div style="width: 100%"></div></div></td>
			<td><a href="#fragment0" onclick="toggle(this); return false"><span>ImageStore/Directory/Directory.php</span></a></td>
		</tr>
		</table>

		<div class="code" id="fragment0">
		<div><span class='line'> 1:    </span><code><span style="color: #06B">
<span style="color: #000">&lt;?php<br>
<span class='line'> 2:    </span><br>
<span class='line'> 3:    </span></span><span style="color: #D24; font-weight: bold">namespace&nbsp;</span><span style="color: #000">Rostenkowski</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">ImageStore</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">Directory</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'> 4:    </span><br>
<span class='line'> 5:    </span><br>
<span class='line'> 6:    </span>use&nbsp;</span><span style="color: #000">Nette</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">Object</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'> 7:    </span>use&nbsp;</span><span style="color: #000">Rostenkowski</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">ImageStore</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">Exceptions</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">DirectoryException</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'> 8:    </span><br>
<span class='line'> 9:    </span></span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>10:    </span>&nbsp;*&nbsp;Directory&nbsp;wrapper<br>
<span class='line'>11:    </span>&nbsp;*/<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #999; font-style: italic"><span class='line'>12:    </span></span><span style="color: #D24; font-weight: bold">class&nbsp;</span><span style="color: #000">Directory&nbsp;</span><span style="color: #D24; font-weight: bold">extends&nbsp;</span><span style="color: #000">Object<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #000"><span class='line'>13:    </span></span><span style="color: #D24; font-weight: bold">{<br>
<span class='line'>14:    </span><br>
<span class='line'>15:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>16:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@var&nbsp;string<br>
<span class='line'>17:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>18:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">private&nbsp;</span><span style="color: #000">$name</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'>19:    </span><br>
<span class='line'>20:    </span><br>
<span class='line'>21:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>22:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;string&nbsp;&nbsp;$name<br>
<span class='line'>23:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;boolean&nbsp;$tryCreateDirectories<br>
<span class='line'>24:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>25:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">public&nbsp;function&nbsp;</span><span style="color: #000">__construct</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$name</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">$tryCreateDirectories&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">TRUE</span><span style="color: #D24; font-weight: bold">)<br>
<span class='line'>26:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>27:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">name&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">check</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$name</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">$tryCreateDirectories</span><span style="color: #D24; font-weight: bold">);<br>
<span class='line'>28:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>29:    </span><br>
<span class='line'>30:    </span><br>
<span class='line'>31:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>32:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Checks&nbsp;a&nbsp;directory&nbsp;to&nbsp;be&nbsp;existing&nbsp;and&nbsp;writable.<br>
<span class='line'>33:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Tries&nbsp;to&nbsp;create&nbsp;it&nbsp;if&nbsp;it&nbsp;does&nbsp;not&nbsp;exist.<br>
<span class='line'>34:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'>35:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;string&nbsp;&nbsp;$name&nbsp;Directory&nbsp;name<br>
<span class='line'>36:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;boolean&nbsp;$tryCreateDirectories<br>
<span class='line'>37:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;string&nbsp;Existing&nbsp;and&nbsp;writable&nbsp;directory&nbsp;name<br>
<span class='line'>38:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>39:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">private&nbsp;function&nbsp;</span><span style="color: #000">check</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$name</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">$tryCreateDirectories&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">TRUE</span><span style="color: #D24; font-weight: bold">)<br>
<span class='line'>40:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>41:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$exists&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">TRUE</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'>42:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$isWritable&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">TRUE</span><span style="color: #D24; font-weight: bold">;<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>43:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>44:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!</span><span style="color: #000">file_exists</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$name</span><span style="color: #D24; font-weight: bold">))&nbsp;{<br>
<span class='line'>45:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$exists&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">FALSE</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'>46:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span style="color: #000">$tryCreateDirectories</span><span style="color: #D24; font-weight: bold">)&nbsp;{<br>
<span class='line'>47:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">umask</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">0002</span><span style="color: #D24; font-weight: bold">);<br>
<span class='line'>48:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$exists&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;@</span><span style="color: #000">mkdir</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$name</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">0750</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">TRUE</span><span style="color: #D24; font-weight: bold">);&nbsp;</span><span style="color: #999; font-style: italic">//&nbsp;@:&nbsp;will&nbsp;be&nbsp;escalated&nbsp;to&nbsp;exception&nbsp;on&nbsp;failure<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #999; font-style: italic"><span class='line'>49:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">}<br>
<span class='line'>50:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>51:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!</span><span style="color: #000">is_writable</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$name</span><span style="color: #D24; font-weight: bold">))&nbsp;{<br>
<span class='line'>52:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$isWritable&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">FALSE</span><span style="color: #D24; font-weight: bold">;<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>53:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
<span class='line'>54:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>55:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!</span><span style="color: #000">$exists&nbsp;</span><span style="color: #D24; font-weight: bold">||&nbsp;!</span><span style="color: #000">$isWritable</span><span style="color: #D24; font-weight: bold">)&nbsp;{<br>
<span class='line'>56:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;</span><span style="color: #000">DirectoryException</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$name</span><span style="color: #D24; font-weight: bold">);<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>57:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
<span class='line'>58:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>59:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #000">$name</span><span style="color: #D24; font-weight: bold">;<br>
</span></span></code></div>
<div class='dead'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>60:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>61:    </span><br>
<span class='line'>62:    </span><br>
<span class='line'>63:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>64:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;string<br>
<span class='line'>65:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>66:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">public&nbsp;function&nbsp;</span><span style="color: #000">__toString</span><span style="color: #D24; font-weight: bold">()<br>
<span class='line'>67:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>68:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;(string)&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">name</span><span style="color: #D24; font-weight: bold">;<br>
</span></span></code></div>
<div class='dead'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>69:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>70:    </span><br>
<span class='line'>71:    </span><br>
<span class='line'>72:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>73:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;TRUE&nbsp;if&nbsp;the&nbsp;compared&nbsp;directory&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;this,&nbsp;FALSE&nbsp;otherwise.<br>
<span class='line'>74:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'>75:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;Directory&nbsp;$to<br>
<span class='line'>76:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;boolean<br>
<span class='line'>77:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>78:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">public&nbsp;function&nbsp;</span><span style="color: #000">is</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">Directory&nbsp;$to</span><span style="color: #D24; font-weight: bold">)<br>
<span class='line'>79:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>80:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #000">realpath</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">name</span><span style="color: #D24; font-weight: bold">)&nbsp;===&nbsp;</span><span style="color: #000">realpath</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$to</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">name</span><span style="color: #D24; font-weight: bold">);<br>
</span></span></code></div>
<div class='dead'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>81:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>82:    </span><br>
<span class='line'>83:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>84:    </span>}<br>
</span></span></code></div>
</div>
	</div>
		<div>
		<table>
		<tr class='light'>
			<td class="number"><small>100 %</small></td>
			<td><div class="bar"><div style="width: 100%"></div></div></td>
			<td><a href="#fragment1" onclick="toggle(this); return false"><span>ImageStore/File.php</span></a></td>
		</tr>
		</table>

		<div class="code" id="fragment1">
		<div><span class='line'> 1:    </span><code><span style="color: #06B">
<span style="color: #000">&lt;?php<br>
<span class='line'> 2:    </span><br>
<span class='line'> 3:    </span></span><span style="color: #D24; font-weight: bold">namespace&nbsp;</span><span style="color: #000">Rostenkowski</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">ImageStore</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'> 4:    </span><br>
<span class='line'> 5:    </span><br>
<span class='line'> 6:    </span></span><span style="color: #999; font-style: italic">/**<br>
<span class='line'> 7:    </span>&nbsp;*&nbsp;Image&nbsp;file&nbsp;interface<br>
<span class='line'> 8:    </span>&nbsp;*/<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #999; font-style: italic"><span class='line'> 9:    </span></span><span style="color: #D24; font-weight: bold">interface&nbsp;</span><span style="color: #000">File<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #000"><span class='line'>10:    </span></span><span style="color: #D24; font-weight: bold">{<br>
<span class='line'>11:    </span><br>
<span class='line'>12:    </span><br>
<span class='line'>13:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>14:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;image&nbsp;filename.<br>
<span class='line'>15:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'>16:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;string<br>
<span class='line'>17:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>18:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">public&nbsp;function&nbsp;</span><span style="color: #000">getName</span><span style="color: #D24; font-weight: bold">();<br>
<span class='line'>19:    </span><br>
<span class='line'>20:    </span><br>
<span class='line'>21:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>22:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;image&nbsp;type.<br>
<span class='line'>23:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'>24:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;integer<br>
<span class='line'>25:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>26:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">public&nbsp;function&nbsp;</span><span style="color: #000">getType</span><span style="color: #D24; font-weight: bold">();<br>
<span class='line'>27:    </span><br>
<span class='line'>28:    </span><br>
<span class='line'>29:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>30:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Sets&nbsp;the&nbsp;image&nbsp;filename.<br>
<span class='line'>31:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'>32:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;string&nbsp;$name<br>
<span class='line'>33:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>34:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">public&nbsp;function&nbsp;</span><span style="color: #000">setName</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$name</span><span style="color: #D24; font-weight: bold">);<br>
<span class='line'>35:    </span><br>
<span class='line'>36:    </span><br>
<span class='line'>37:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>38:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Sets&nbsp;the&nbsp;image&nbsp;type.<br>
<span class='line'>39:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'>40:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;integer&nbsp;$type<br>
<span class='line'>41:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>42:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">public&nbsp;function&nbsp;</span><span style="color: #000">setType</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$type</span><span style="color: #D24; font-weight: bold">);<br>
<span class='line'>43:    </span><br>
<span class='line'>44:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>45:    </span>}<br>
</span></span></code></div>
</div>
	</div>
		<div>
		<table>
		<tr class='light'>
			<td class="number"><small>100 %</small></td>
			<td><div class="bar"><div style="width: 100%"></div></div></td>
			<td><a href="#fragment2" onclick="toggle(this); return false"><span>ImageStore/Meta.php</span></a></td>
		</tr>
		</table>

		<div class="code" id="fragment2">
		<div><span class='line'> 1:    </span><code><span style="color: #06B">
<span style="color: #000">&lt;?php<br>
<span class='line'> 2:    </span><br>
<span class='line'> 3:    </span></span><span style="color: #D24; font-weight: bold">namespace&nbsp;</span><span style="color: #000">Rostenkowski</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">ImageStore</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'> 4:    </span><br>
<span class='line'> 5:    </span><br>
<span class='line'> 6:    </span></span><span style="color: #999; font-style: italic">/**<br>
<span class='line'> 7:    </span>&nbsp;*&nbsp;Image&nbsp;meta&nbsp;information&nbsp;interface<br>
<span class='line'> 8:    </span>&nbsp;*/<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #999; font-style: italic"><span class='line'> 9:    </span></span><span style="color: #D24; font-weight: bold">interface&nbsp;</span><span style="color: #000">Meta<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #000"><span class='line'>10:    </span></span><span style="color: #D24; font-weight: bold">{<br>
<span class='line'>11:    </span><br>
<span class='line'>12:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>13:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;image&nbsp;SHA1&nbsp;hash.<br>
<span class='line'>14:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'>15:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;string<br>
<span class='line'>16:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>17:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">public&nbsp;function&nbsp;</span><span style="color: #000">getHash</span><span style="color: #D24; font-weight: bold">();<br>
<span class='line'>18:    </span><br>
<span class='line'>19:    </span><br>
<span class='line'>20:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>21:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;image&nbsp;type.<br>
<span class='line'>22:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'>23:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;integer<br>
<span class='line'>24:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>25:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">public&nbsp;function&nbsp;</span><span style="color: #000">getType</span><span style="color: #D24; font-weight: bold">();<br>
<span class='line'>26:    </span><br>
<span class='line'>27:    </span><br>
<span class='line'>28:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>29:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Sets&nbsp;the&nbsp;image&nbsp;SHA1&nbsp;hash.<br>
<span class='line'>30:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'>31:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;string&nbsp;$hash<br>
<span class='line'>32:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>33:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">public&nbsp;function&nbsp;</span><span style="color: #000">setHash</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$hash</span><span style="color: #D24; font-weight: bold">);<br>
<span class='line'>34:    </span><br>
<span class='line'>35:    </span><br>
<span class='line'>36:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>37:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Sets&nbsp;the&nbsp;image&nbsp;type.<br>
<span class='line'>38:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'>39:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;integer&nbsp;$type<br>
<span class='line'>40:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>41:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">public&nbsp;function&nbsp;</span><span style="color: #000">setType</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$type</span><span style="color: #D24; font-weight: bold">);<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>42:    </span>}<br>
</span></span></code></div>
</div>
	</div>
		<div>
		<table>
		<tr>
			<td class="number"><small>100 %</small></td>
			<td><div class="bar"><div style="width: 100%"></div></div></td>
			<td><a href="#fragment3" onclick="toggle(this); return false"><span>ImageStore/Macro/ImageMacro.php</span></a></td>
		</tr>
		</table>

		<div class="code" id="fragment3">
		<div><span class='line'>  1:    </span><code><span style="color: #06B">
<span style="color: #000">&lt;?php<br>
<span class='line'>  2:    </span><br>
<span class='line'>  3:    </span></span><span style="color: #D24; font-weight: bold">namespace&nbsp;</span><span style="color: #000">Rostenkowski</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">ImageStore</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">Macro</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'>  4:    </span><br>
<span class='line'>  5:    </span><br>
<span class='line'>  6:    </span>use&nbsp;</span><span style="color: #000">Latte</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">Compiler</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'>  7:    </span>use&nbsp;</span><span style="color: #000">Latte</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">MacroNode</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'>  8:    </span>use&nbsp;</span><span style="color: #000">Latte</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">Macros</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">MacroSet</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'>  9:    </span>use&nbsp;</span><span style="color: #000">Latte</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">PhpWriter</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'> 10:    </span><br>
<span class='line'> 11:    </span></span><span style="color: #999; font-style: italic">/**<br>
<span class='line'> 12:    </span>&nbsp;*&nbsp;Latte&nbsp;template&nbsp;engine&nbsp;image&nbsp;macros<br>
<span class='line'> 13:    </span>&nbsp;*/<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #999; font-style: italic"><span class='line'> 14:    </span></span><span style="color: #D24; font-weight: bold">class&nbsp;</span><span style="color: #000">ImageMacro&nbsp;</span><span style="color: #D24; font-weight: bold">extends&nbsp;</span><span style="color: #000">MacroSet<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #000"><span class='line'> 15:    </span></span><span style="color: #D24; font-weight: bold">{<br>
<span class='line'> 16:    </span><br>
<span class='line'> 17:    </span><br>
<span class='line'> 18:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'> 19:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Installs&nbsp;the&nbsp;macro&nbsp;set&nbsp;into&nbsp;the&nbsp;template&nbsp;compiler.<br>
<span class='line'> 20:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'> 21:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;Compiler&nbsp;$compiler<br>
<span class='line'> 22:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;void|static<br>
<span class='line'> 23:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'> 24:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">public&nbsp;static&nbsp;function&nbsp;</span><span style="color: #000">install</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">Compiler&nbsp;$compiler</span><span style="color: #D24; font-weight: bold">)<br>
<span class='line'> 25:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'> 26:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$macroSet&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;new&nbsp;static(</span><span style="color: #000">$compiler</span><span style="color: #D24; font-weight: bold">);<br>
<span class='line'> 27:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$macroSet</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">setup</span><span style="color: #D24; font-weight: bold">();<br>
<span class='line'> 28:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'> 29:    </span><br>
<span class='line'> 30:    </span><br>
<span class='line'> 31:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'> 32:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Sets&nbsp;the&nbsp;template&nbsp;macros&nbsp;up.<br>
<span class='line'> 33:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'> 34:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">public&nbsp;function&nbsp;</span><span style="color: #000">setup</span><span style="color: #D24; font-weight: bold">()<br>
<span class='line'> 35:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'> 36:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">addMacro</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #080">'src'</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">NULL</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">NULL</span><span style="color: #D24; font-weight: bold">,&nbsp;[</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #080">'macroSrc'</span><span style="color: #D24; font-weight: bold">]);<br>
<span class='line'> 37:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">addMacro</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #080">'bg'</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">NULL</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">NULL</span><span style="color: #D24; font-weight: bold">,&nbsp;[</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #080">'macroBg'</span><span style="color: #D24; font-weight: bold">]);<br>
<span class='line'> 38:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">addMacro</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #080">'image'</span><span style="color: #D24; font-weight: bold">,&nbsp;[</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #080">'macroImageBegin'</span><span style="color: #D24; font-weight: bold">],&nbsp;</span><span style="color: #000">NULL</span><span style="color: #D24; font-weight: bold">,&nbsp;[</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #080">'macroImage'</span><span style="color: #D24; font-weight: bold">]);<br>
<span class='line'> 39:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">addMacro</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #080">'crop'</span><span style="color: #D24; font-weight: bold">,&nbsp;[</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #080">'macroCropBegin'</span><span style="color: #D24; font-weight: bold">],&nbsp;</span><span style="color: #000">NULL</span><span style="color: #D24; font-weight: bold">,&nbsp;[</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #080">'macroCrop'</span><span style="color: #D24; font-weight: bold">]);<br>
<span class='line'> 40:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'> 41:    </span><br>
<span class='line'> 42:    </span><br>
<span class='line'> 43:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'> 44:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Renders&nbsp;the&nbsp;`n:src="$image"`&nbsp;macro.<br>
<span class='line'> 45:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'> 46:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;MacroNode&nbsp;$node<br>
<span class='line'> 47:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;PhpWriter&nbsp;$writer<br>
<span class='line'> 48:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;string<br>
<span class='line'> 49:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'> 50:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">public&nbsp;function&nbsp;</span><span style="color: #000">macroBg</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">MacroNode&nbsp;$node</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">PhpWriter&nbsp;$writer</span><span style="color: #D24; font-weight: bold">)<br>
<span class='line'> 51:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'> 52:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #000">$writer</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">write</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #080">'&nbsp;?&gt;&nbsp;style="background-image:&nbsp;url(\'&lt;?php&nbsp;$imageRequest&nbsp;=&nbsp;Rostenkowski\ImageStore\Requests\ImageRequest::crop(%node.word,&nbsp;%node.array?);&nbsp;echo&nbsp;%escape($__imagestore-&gt;link($imageRequest));&nbsp;?&gt;\');"&lt;?php&nbsp;'</span><span style="color: #D24; font-weight: bold">);<br>
</span></span></code></div>
<div class='dead'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'> 53:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'> 54:    </span><br>
<span class='line'> 55:    </span><br>
<span class='line'> 56:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'> 57:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Renders&nbsp;the&nbsp;`n:crop="$image"`&nbsp;macro.<br>
<span class='line'> 58:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'> 59:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;MacroNode&nbsp;$node<br>
<span class='line'> 60:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;PhpWriter&nbsp;$writer<br>
<span class='line'> 61:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;string<br>
<span class='line'> 62:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'> 63:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">public&nbsp;function&nbsp;</span><span style="color: #000">macroCrop</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">MacroNode&nbsp;$node</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">PhpWriter&nbsp;$writer</span><span style="color: #D24; font-weight: bold">)<br>
<span class='line'> 64:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'> 65:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #000">$writer</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">write</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #080">'&nbsp;?&gt;&nbsp;src="&lt;?php&nbsp;$imageRequest&nbsp;=&nbsp;Rostenkowski\ImageStore\Requests\ImageRequest::crop(%node.word,&nbsp;%node.array?);&nbsp;echo&nbsp;%escape($__imagestore-&gt;link($imageRequest));&nbsp;?&gt;"&lt;?php&nbsp;'</span><span style="color: #D24; font-weight: bold">);<br>
</span></span></code></div>
<div class='dead'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'> 66:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'> 67:    </span><br>
<span class='line'> 68:    </span><br>
<span class='line'> 69:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'> 70:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Renders&nbsp;the&nbsp;`{crop&nbsp;$image&nbsp;...}`&nbsp;macro.<br>
<span class='line'> 71:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'> 72:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;MacroNode&nbsp;$node<br>
<span class='line'> 73:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;PhpWriter&nbsp;$writer<br>
<span class='line'> 74:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;string<br>
<span class='line'> 75:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'> 76:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">public&nbsp;function&nbsp;</span><span style="color: #000">macroCropBegin</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">MacroNode&nbsp;$node</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">PhpWriter&nbsp;$writer</span><span style="color: #D24; font-weight: bold">)<br>
<span class='line'> 77:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'> 78:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #000">$writer</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">write</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #080">'$imageRequest&nbsp;=&nbsp;Rostenkowski\ImageStore\Requests\ImageRequest::crop(%node.word,&nbsp;%node.array?);&nbsp;echo&nbsp;%escape($__imagestore-&gt;link($imageRequest));'</span><span style="color: #D24; font-weight: bold">);<br>
</span></span></code></div>
<div class='dead'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'> 79:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'> 80:    </span><br>
<span class='line'> 81:    </span><br>
<span class='line'> 82:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'> 83:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Renders&nbsp;the&nbsp;`n:image="$image"`&nbsp;macro.<br>
<span class='line'> 84:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'> 85:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;MacroNode&nbsp;$node<br>
<span class='line'> 86:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;PhpWriter&nbsp;$writer<br>
<span class='line'> 87:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;string<br>
<span class='line'> 88:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'> 89:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">public&nbsp;function&nbsp;</span><span style="color: #000">macroImage</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">MacroNode&nbsp;$node</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">PhpWriter&nbsp;$writer</span><span style="color: #D24; font-weight: bold">)<br>
<span class='line'> 90:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'> 91:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #000">$writer</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">write</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #080">'&nbsp;?&gt;&nbsp;href="&lt;?php&nbsp;$imageRequest&nbsp;=&nbsp;Rostenkowski\ImageStore\Requests\ImageRequest::fromMacro(%node.word,&nbsp;%node.array?);&nbsp;echo&nbsp;%escape($__imagestore-&gt;link($imageRequest));&nbsp;?&gt;"&lt;?php&nbsp;'</span><span style="color: #D24; font-weight: bold">);<br>
</span></span></code></div>
<div class='dead'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'> 92:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'> 93:    </span><br>
<span class='line'> 94:    </span><br>
<span class='line'> 95:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'> 96:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Renders&nbsp;the&nbsp;`{image&nbsp;$image&nbsp;...}`&nbsp;macro.<br>
<span class='line'> 97:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'> 98:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;MacroNode&nbsp;$node<br>
<span class='line'> 99:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;PhpWriter&nbsp;$writer<br>
<span class='line'>100:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;string<br>
<span class='line'>101:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>102:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">public&nbsp;function&nbsp;</span><span style="color: #000">macroImageBegin</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">MacroNode&nbsp;$node</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">PhpWriter&nbsp;$writer</span><span style="color: #D24; font-weight: bold">)<br>
<span class='line'>103:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>104:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #000">$writer</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">write</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #080">'$imageRequest&nbsp;=&nbsp;Rostenkowski\ImageStore\Requests\ImageRequest::fromMacro(%node.word,&nbsp;%node.array?);&nbsp;echo&nbsp;%escape($__imagestore-&gt;link($imageRequest));'</span><span style="color: #D24; font-weight: bold">);<br>
</span></span></code></div>
<div class='dead'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>105:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>106:    </span><br>
<span class='line'>107:    </span><br>
<span class='line'>108:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>109:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Renders&nbsp;the&nbsp;`n:src="$image"`&nbsp;macro.<br>
<span class='line'>110:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'>111:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;MacroNode&nbsp;$node<br>
<span class='line'>112:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;PhpWriter&nbsp;$writer<br>
<span class='line'>113:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;string<br>
<span class='line'>114:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>115:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">public&nbsp;function&nbsp;</span><span style="color: #000">macroSrc</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">MacroNode&nbsp;$node</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">PhpWriter&nbsp;$writer</span><span style="color: #D24; font-weight: bold">)<br>
<span class='line'>116:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>117:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #000">$writer</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">write</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #080">'$imageRequest&nbsp;=&nbsp;Rostenkowski\ImageStore\Requests\ImageRequest::fromMacro(%node.word,&nbsp;%node.array?);&nbsp;?&gt;&nbsp;src="&lt;?php&nbsp;echo&nbsp;%escape($__imagestore-&gt;link($imageRequest));&nbsp;?&gt;"&lt;?php&nbsp;'</span><span style="color: #D24; font-weight: bold">);<br>
</span></span></code></div>
<div class='dead'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>118:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>119:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>120:    </span>}<br>
</span></span></code></div>
</div>
	</div>
		<div>
		<table>
		<tr class='light'>
			<td class="number"><small>100 %</small></td>
			<td><div class="bar"><div style="width: 100%"></div></div></td>
			<td><a href="#fragment4" onclick="toggle(this); return false"><span>ImageStore/Request.php</span></a></td>
		</tr>
		</table>

		<div class="code" id="fragment4">
		<div><span class='line'> 1:    </span><code><span style="color: #06B">
<span style="color: #000">&lt;?php<br>
<span class='line'> 2:    </span><br>
<span class='line'> 3:    </span></span><span style="color: #D24; font-weight: bold">namespace&nbsp;</span><span style="color: #000">Rostenkowski</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">ImageStore</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'> 4:    </span><br>
<span class='line'> 5:    </span><br>
<span class='line'> 6:    </span></span><span style="color: #999; font-style: italic">/**<br>
<span class='line'> 7:    </span>&nbsp;*&nbsp;Image&nbsp;request&nbsp;interface<br>
<span class='line'> 8:    </span>&nbsp;*/<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #999; font-style: italic"><span class='line'> 9:    </span></span><span style="color: #D24; font-weight: bold">interface&nbsp;</span><span style="color: #000">Request<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #000"><span class='line'>10:    </span></span><span style="color: #D24; font-weight: bold">{<br>
<span class='line'>11:    </span><br>
<span class='line'>12:    </span>&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;</span><span style="color: #000">ORIGINAL&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">0</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'>13:    </span><br>
<span class='line'>14:    </span><br>
<span class='line'>15:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>16:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;requested&nbsp;image&nbsp;thumbnail&nbsp;cropping&nbsp;flag.<br>
<span class='line'>17:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'>18:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;integer<br>
<span class='line'>19:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>20:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">public&nbsp;function&nbsp;</span><span style="color: #000">getCrop</span><span style="color: #D24; font-weight: bold">();<br>
<span class='line'>21:    </span><br>
<span class='line'>22:    </span><br>
<span class='line'>23:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>24:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;requested&nbsp;image&nbsp;thumbnail&nbsp;dimensions.<br>
<span class='line'>25:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'>26:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;string<br>
<span class='line'>27:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>28:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">public&nbsp;function&nbsp;</span><span style="color: #000">getDimensions</span><span style="color: #D24; font-weight: bold">();<br>
<span class='line'>29:    </span><br>
<span class='line'>30:    </span><br>
<span class='line'>31:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>32:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;requested&nbsp;image&nbsp;thumbnail&nbsp;flags.<br>
<span class='line'>33:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'>34:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;integer<br>
<span class='line'>35:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>36:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">public&nbsp;function&nbsp;</span><span style="color: #000">getFlags</span><span style="color: #D24; font-weight: bold">();<br>
<span class='line'>37:    </span><br>
<span class='line'>38:    </span><br>
<span class='line'>39:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>40:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;requested&nbsp;image&nbsp;meta&nbsp;information.<br>
<span class='line'>41:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'>42:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;Meta<br>
<span class='line'>43:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>44:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">public&nbsp;function&nbsp;</span><span style="color: #000">getMeta</span><span style="color: #D24; font-weight: bold">();<br>
<span class='line'>45:    </span><br>
<span class='line'>46:    </span><br>
<span class='line'>47:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>48:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Sets&nbsp;the&nbsp;requested&nbsp;image&nbsp;meta&nbsp;information.<br>
<span class='line'>49:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'>50:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;Meta&nbsp;$meta<br>
<span class='line'>51:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;Request<br>
<span class='line'>52:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>53:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">public&nbsp;function&nbsp;</span><span style="color: #000">setMeta</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">Meta&nbsp;$meta</span><span style="color: #D24; font-weight: bold">);<br>
<span class='line'>54:    </span><br>
<span class='line'>55:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>56:    </span>}<br>
</span></span></code></div>
</div>
	</div>
		<div>
		<table>
		<tr>
			<td class="number"><small>100 %</small></td>
			<td><div class="bar"><div style="width: 100%"></div></div></td>
			<td><a href="#fragment5" onclick="toggle(this); return false"><span>ImageStore/ImageStorage.php</span></a></td>
		</tr>
		</table>

		<div class="code" id="fragment5">
		<div><span class='line'>  1:    </span><code><span style="color: #06B">
<span style="color: #000">&lt;?php<br>
<span class='line'>  2:    </span><br>
<span class='line'>  3:    </span></span><span style="color: #D24; font-weight: bold">namespace&nbsp;</span><span style="color: #000">Rostenkowski</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">ImageStore</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'>  4:    </span><br>
<span class='line'>  5:    </span><br>
<span class='line'>  6:    </span>use&nbsp;</span><span style="color: #000">Nette</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">Application</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">Responses</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">FileResponse</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'>  7:    </span>use&nbsp;</span><span style="color: #000">Nette</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">Http</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">FileUpload</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'>  8:    </span>use&nbsp;</span><span style="color: #000">Nette</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">Object</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'>  9:    </span>use&nbsp;</span><span style="color: #000">Nette</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">Utils</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">Image</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'> 10:    </span>use&nbsp;</span><span style="color: #000">Nette</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">Utils</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">Strings</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'> 11:    </span>use&nbsp;</span><span style="color: #000">Rostenkowski</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">ImageStore</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">Directory</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">Directory</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'> 12:    </span>use&nbsp;</span><span style="color: #000">Rostenkowski</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">ImageStore</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">Entity</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">EmptyImage</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'> 13:    </span>use&nbsp;</span><span style="color: #000">Rostenkowski</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">ImageStore</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">Entity</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">ImageEnvelope</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'> 14:    </span>use&nbsp;</span><span style="color: #000">Rostenkowski</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">ImageStore</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">Exceptions</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">ImageTypeException</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'> 15:    </span>use&nbsp;</span><span style="color: #000">Rostenkowski</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">ImageStore</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">Exceptions</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">InvalidCacheDirectoryException</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'> 16:    </span>use&nbsp;</span><span style="color: #000">Rostenkowski</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">ImageStore</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">Exceptions</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">UploaderException</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'> 17:    </span>use&nbsp;</span><span style="color: #000">Rostenkowski</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">ImageStore</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">Files</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">ImageFile</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'> 18:    </span><br>
<span class='line'> 19:    </span></span><span style="color: #999; font-style: italic">/**<br>
<span class='line'> 20:    </span>&nbsp;*&nbsp;Image&nbsp;file&nbsp;storage<br>
<span class='line'> 21:    </span>&nbsp;*<br>
<span class='line'> 22:    </span>&nbsp;*&nbsp;-&nbsp;The&nbsp;images&nbsp;are&nbsp;stored&nbsp;in&nbsp;a&nbsp;regular&nbsp;files&nbsp;in&nbsp;the&nbsp;given&nbsp;`$directory`.<br>
<span class='line'> 23:    </span>&nbsp;*&nbsp;-&nbsp;The&nbsp;files&nbsp;are&nbsp;organized&nbsp;in&nbsp;a&nbsp;2-level&nbsp;directory&nbsp;structure&nbsp;with&nbsp;maximum&nbsp;of&nbsp;256²&nbsp;directories.<br>
<span class='line'> 24:    </span>&nbsp;*&nbsp;-&nbsp;The&nbsp;directory&nbsp;tree&nbsp;is&nbsp;well&nbsp;balanced&nbsp;thanks&nbsp;to&nbsp;the&nbsp;image&nbsp;hashes&nbsp;used&nbsp;for&nbsp;the&nbsp;directory&nbsp;path&nbsp;creation.<br>
<span class='line'> 25:    </span>&nbsp;*&nbsp;-&nbsp;The&nbsp;storage&nbsp;stores&nbsp;only&nbsp;one&nbsp;file&nbsp;even&nbsp;if&nbsp;the&nbsp;same&nbsp;image&nbsp;is&nbsp;stored&nbsp;multiple&nbsp;times,&nbsp;thus&nbsp;images&nbsp;should&nbsp;be<br>
<span class='line'> 26:    </span>&nbsp;*&nbsp;&nbsp;&nbsp;deleted&nbsp;only&nbsp;after&nbsp;it&nbsp;is&nbsp;sure&nbsp;it&nbsp;is&nbsp;not&nbsp;referenced&nbsp;from&nbsp;other&nbsp;entities.<br>
<span class='line'> 27:    </span>&nbsp;*&nbsp;-&nbsp;The&nbsp;image&nbsp;thumbnails&nbsp;are&nbsp;created&nbsp;on&nbsp;demand&nbsp;and&nbsp;cached&nbsp;in&nbsp;the&nbsp;`$cacheDirectory`.<br>
<span class='line'> 28:    </span>&nbsp;*/<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #999; font-style: italic"><span class='line'> 29:    </span></span><span style="color: #D24; font-weight: bold">class&nbsp;</span><span style="color: #000">ImageStorage&nbsp;</span><span style="color: #D24; font-weight: bold">extends&nbsp;</span><span style="color: #000">Object&nbsp;</span><span style="color: #D24; font-weight: bold">implements&nbsp;</span><span style="color: #000">Storage<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #000"><span class='line'> 30:    </span></span><span style="color: #D24; font-weight: bold">{<br>
<span class='line'> 31:    </span><br>
<span class='line'> 32:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'> 33:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;The&nbsp;directory&nbsp;to&nbsp;store&nbsp;the&nbsp;images&nbsp;in<br>
<span class='line'> 34:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'> 35:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@var&nbsp;Directory<br>
<span class='line'> 36:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'> 37:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">private&nbsp;</span><span style="color: #000">$directory</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'> 38:    </span><br>
<span class='line'> 39:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'> 40:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;The&nbsp;image&nbsp;type&nbsp;-&gt;&nbsp;file&nbsp;extension&nbsp;map<br>
<span class='line'> 41:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'> 42:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@var&nbsp;array<br>
<span class='line'> 43:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'> 44:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">private&nbsp;</span><span style="color: #000">$extensions&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;array(</span><span style="color: #000">Image</span><span style="color: #D24; font-weight: bold">::</span><span style="color: #000">JPEG&nbsp;</span><span style="color: #D24; font-weight: bold">=&gt;&nbsp;</span><span style="color: #080">'jpg'</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">Image</span><span style="color: #D24; font-weight: bold">::</span><span style="color: #000">PNG&nbsp;</span><span style="color: #D24; font-weight: bold">=&gt;&nbsp;</span><span style="color: #080">'png'</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">Image</span><span style="color: #D24; font-weight: bold">::</span><span style="color: #000">GIF&nbsp;</span><span style="color: #D24; font-weight: bold">=&gt;&nbsp;</span><span style="color: #080">'gif'</span><span style="color: #D24; font-weight: bold">);<br>
<span class='line'> 45:    </span><br>
<span class='line'> 46:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'> 47:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;The&nbsp;image&nbsp;type&nbsp;-&gt;&nbsp;MIME&nbsp;type&nbsp;map<br>
<span class='line'> 48:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'> 49:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@var&nbsp;array<br>
<span class='line'> 50:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'> 51:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">private&nbsp;</span><span style="color: #000">$mimeTypes&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;array(</span><span style="color: #000">Image</span><span style="color: #D24; font-weight: bold">::</span><span style="color: #000">JPEG&nbsp;</span><span style="color: #D24; font-weight: bold">=&gt;&nbsp;</span><span style="color: #080">'image/jpeg'</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">Image</span><span style="color: #D24; font-weight: bold">::</span><span style="color: #000">PNG&nbsp;</span><span style="color: #D24; font-weight: bold">=&gt;&nbsp;</span><span style="color: #080">'image/png'</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">Image</span><span style="color: #D24; font-weight: bold">::</span><span style="color: #000">GIF&nbsp;</span><span style="color: #D24; font-weight: bold">=&gt;&nbsp;</span><span style="color: #080">'image/gif'</span><span style="color: #D24; font-weight: bold">);<br>
<span class='line'> 52:    </span><br>
<span class='line'> 53:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'> 54:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;The&nbsp;public&nbsp;accessible&nbsp;URL&nbsp;of&nbsp;the&nbsp;cache&nbsp;directory<br>
<span class='line'> 55:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'> 56:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@var&nbsp;string<br>
<span class='line'> 57:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'> 58:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">private&nbsp;</span><span style="color: #000">$baseUrl</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'> 59:    </span><br>
<span class='line'> 60:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'> 61:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;The&nbsp;cache&nbsp;directory<br>
<span class='line'> 62:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'> 63:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@var&nbsp;Directory<br>
<span class='line'> 64:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'> 65:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">private&nbsp;</span><span style="color: #000">$cacheDirectory</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'> 66:    </span><br>
<span class='line'> 67:    </span><br>
<span class='line'> 68:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'> 69:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Constructs&nbsp;the&nbsp;image&nbsp;file&nbsp;storage&nbsp;from&nbsp;the&nbsp;given&nbsp;arguments.<br>
<span class='line'> 70:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'> 71:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;string&nbsp;&nbsp;$directory&nbsp;The&nbsp;directory&nbsp;to&nbsp;store&nbsp;the&nbsp;images&nbsp;in<br>
<span class='line'> 72:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;string&nbsp;&nbsp;$cacheDirectory<br>
<span class='line'> 73:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;string&nbsp;&nbsp;$baseUrl<br>
<span class='line'> 74:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;boolean&nbsp;$tryCreateDirectories<br>
<span class='line'> 75:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'> 76:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">public&nbsp;function&nbsp;</span><span style="color: #000">__construct</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$directory</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">$cacheDirectory</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">$baseUrl&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #080">'/cache/'</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">$tryCreateDirectories&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">TRUE</span><span style="color: #D24; font-weight: bold">)<br>
<span class='line'> 77:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'> 78:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">directory&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;new&nbsp;</span><span style="color: #000">Directory</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$directory</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">$tryCreateDirectories</span><span style="color: #D24; font-weight: bold">);<br>
<span class='line'> 79:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">cacheDirectory&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;new&nbsp;</span><span style="color: #000">Directory</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$cacheDirectory</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">$tryCreateDirectories</span><span style="color: #D24; font-weight: bold">);<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'> 80:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'> 81:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">directory</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">is</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">cacheDirectory</span><span style="color: #D24; font-weight: bold">))&nbsp;{<br>
<span class='line'> 82:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;</span><span style="color: #000">InvalidCacheDirectoryException</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$cacheDirectory</span><span style="color: #D24; font-weight: bold">);<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'> 83:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
<span class='line'> 84:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'> 85:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">setBaseUrl</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$baseUrl</span><span style="color: #D24; font-weight: bold">);<br>
<span class='line'> 86:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'> 87:    </span><br>
<span class='line'> 88:    </span><br>
<span class='line'> 89:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'> 90:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Fetches&nbsp;the&nbsp;cached&nbsp;copy&nbsp;of&nbsp;an&nbsp;image&nbsp;by&nbsp;given&nbsp;request.<br>
<span class='line'> 91:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'> 92:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;&nbsp;Request&nbsp;$request&nbsp;The&nbsp;image&nbsp;request<br>
<span class='line'> 93:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;Image<br>
<span class='line'> 94:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'> 95:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">public&nbsp;function&nbsp;</span><span style="color: #000">fetch</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">Request&nbsp;$request</span><span style="color: #D24; font-weight: bold">)<br>
<span class='line'> 96:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'> 97:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">checkImage</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$request</span><span style="color: #D24; font-weight: bold">);<br>
<span class='line'> 98:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$filename&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">createCacheFilename</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$request</span><span style="color: #D24; font-weight: bold">);<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'> 99:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>100:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #000">Image</span><span style="color: #D24; font-weight: bold">::</span><span style="color: #000">fromFile</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$filename</span><span style="color: #D24; font-weight: bold">);<br>
</span></span></code></div>
<div class='dead'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>101:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>102:    </span><br>
<span class='line'>103:    </span><br>
<span class='line'>104:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>105:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Fetches&nbsp;the&nbsp;original&nbsp;image&nbsp;by&nbsp;the&nbsp;given&nbsp;image&nbsp;meta&nbsp;information.<br>
<span class='line'>106:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'>107:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;&nbsp;Meta&nbsp;$meta&nbsp;The&nbsp;stored&nbsp;image&nbsp;meta&nbsp;information<br>
<span class='line'>108:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;Image&nbsp;The&nbsp;stored&nbsp;image<br>
<span class='line'>109:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>110:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">public&nbsp;function&nbsp;</span><span style="color: #000">original</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">Meta&nbsp;$meta</span><span style="color: #D24; font-weight: bold">)<br>
<span class='line'>111:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>112:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #000">Image</span><span style="color: #D24; font-weight: bold">::</span><span style="color: #000">fromFile</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">createFilename</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$meta</span><span style="color: #D24; font-weight: bold">));<br>
</span></span></code></div>
<div class='dead'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>113:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>114:    </span><br>
<span class='line'>115:    </span><br>
<span class='line'>116:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>117:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Removes&nbsp;the&nbsp;image&nbsp;from&nbsp;the&nbsp;storage&nbsp;by&nbsp;the&nbsp;given&nbsp;image&nbsp;meta&nbsp;information.<br>
<span class='line'>118:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'>119:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;&nbsp;Meta&nbsp;$meta&nbsp;The&nbsp;image&nbsp;information<br>
<span class='line'>120:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;ImageStorage&nbsp;Fluent&nbsp;interface<br>
<span class='line'>121:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>122:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">public&nbsp;function&nbsp;</span><span style="color: #000">remove</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">Meta&nbsp;$meta</span><span style="color: #D24; font-weight: bold">)<br>
<span class='line'>123:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>124:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">unlink</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">createFilename</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$meta</span><span style="color: #D24; font-weight: bold">));<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>125:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>126:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">;<br>
</span></span></code></div>
<div class='dead'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>127:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>128:    </span><br>
<span class='line'>129:    </span><br>
<span class='line'>130:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>131:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Checks&nbsp;if&nbsp;an&nbsp;image&nbsp;of&nbsp;the&nbsp;given&nbsp;meta&nbsp;information&nbsp;is&nbsp;stored&nbsp;in&nbsp;the&nbsp;storage.<br>
<span class='line'>132:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'>133:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;&nbsp;Meta&nbsp;$meta&nbsp;The&nbsp;image&nbsp;meta&nbsp;information<br>
<span class='line'>134:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;boolean&nbsp;TRUE&nbsp;if&nbsp;image&nbsp;is&nbsp;present&nbsp;in&nbsp;the&nbsp;storage&nbsp;or&nbsp;FALSE&nbsp;otherwise<br>
<span class='line'>135:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>136:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">public&nbsp;function&nbsp;</span><span style="color: #000">contains</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">Meta&nbsp;$meta</span><span style="color: #D24; font-weight: bold">)<br>
<span class='line'>137:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>138:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #000">file_exists</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">createFilename</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$meta</span><span style="color: #D24; font-weight: bold">));<br>
</span></span></code></div>
<div class='dead'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>139:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>140:    </span><br>
<span class='line'>141:    </span><br>
<span class='line'>142:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>143:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Stores&nbsp;the&nbsp;given&nbsp;uploaded&nbsp;file.<br>
<span class='line'>144:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'>145:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;&nbsp;FileUpload&nbsp;$upload<br>
<span class='line'>146:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;&nbsp;meta&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$meta<br>
<span class='line'>147:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;ImageStorage&nbsp;Fluent&nbsp;interface<br>
<span class='line'>148:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;UploaderException<br>
<span class='line'>149:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>150:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">public&nbsp;function&nbsp;</span><span style="color: #000">upload</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">FileUpload&nbsp;$upload</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">Meta&nbsp;$meta</span><span style="color: #D24; font-weight: bold">)<br>
<span class='line'>151:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>152:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span style="color: #000">$upload</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">getError</span><span style="color: #D24; font-weight: bold">())&nbsp;{<br>
<span class='line'>153:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;</span><span style="color: #000">UploaderException</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$upload</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">getError</span><span style="color: #D24; font-weight: bold">());<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>154:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
<span class='line'>155:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>156:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$source&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">$upload</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">getTemporaryFile</span><span style="color: #D24; font-weight: bold">();<br>
<span class='line'>157:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">readMeta</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$source</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">$meta</span><span style="color: #D24; font-weight: bold">);<br>
<span class='line'>158:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$target&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">createFilename</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$meta</span><span style="color: #D24; font-weight: bold">);<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>159:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>160:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">contains</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$meta</span><span style="color: #D24; font-weight: bold">))&nbsp;{<br>
<span class='line'>161:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$image&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">Image</span><span style="color: #D24; font-weight: bold">::</span><span style="color: #000">fromFile</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$source</span><span style="color: #D24; font-weight: bold">);<br>
<span class='line'>162:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$image</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">resize</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">1920</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">1080</span><span style="color: #D24; font-weight: bold">);<br>
<span class='line'>163:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$image</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">save</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$target</span><span style="color: #D24; font-weight: bold">);<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>164:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>165:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span style="color: #000">file_exists</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$source</span><span style="color: #D24; font-weight: bold">))&nbsp;{<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>166:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>167:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">unlink</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$source</span><span style="color: #D24; font-weight: bold">);<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>168:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
<span class='line'>169:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>170:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">;<br>
</span></span></code></div>
<div class='dead'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>171:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>172:    </span><br>
<span class='line'>173:    </span><br>
<span class='line'>174:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>175:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;URL&nbsp;of&nbsp;the&nbsp;cached&nbsp;version&nbsp;of&nbsp;the&nbsp;image.<br>
<span class='line'>176:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'>177:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;&nbsp;Request&nbsp;$request&nbsp;The&nbsp;image&nbsp;request<br>
<span class='line'>178:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;string&nbsp;&nbsp;The&nbsp;URL&nbsp;of&nbsp;the&nbsp;image<br>
<span class='line'>179:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>180:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">public&nbsp;function&nbsp;</span><span style="color: #000">link</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">Request&nbsp;$request</span><span style="color: #D24; font-weight: bold">)<br>
<span class='line'>181:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>182:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">checkImage</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$request</span><span style="color: #D24; font-weight: bold">);<br>
<span class='line'>183:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$filePath&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">createFilePath</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$request</span><span style="color: #D24; font-weight: bold">);<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>184:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>185:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #080">"</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">baseUrl$filePath</span><span style="color: #080">"</span><span style="color: #D24; font-weight: bold">;<br>
</span></span></code></div>
<div class='dead'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>186:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>187:    </span><br>
<span class='line'>188:    </span><br>
<span class='line'>189:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>190:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Creates&nbsp;the&nbsp;file&nbsp;download&nbsp;HTTP&nbsp;response&nbsp;which&nbsp;can&nbsp;be&nbsp;easily&nbsp;sent&nbsp;using&nbsp;the&nbsp;`send()`&nbsp;method.<br>
<span class='line'>191:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'>192:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;&nbsp;Request&nbsp;$request&nbsp;The&nbsp;image&nbsp;request<br>
<span class='line'>193:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;FileResponse<br>
<span class='line'>194:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>195:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">public&nbsp;function&nbsp;</span><span style="color: #000">download</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">Request&nbsp;$request</span><span style="color: #D24; font-weight: bold">)<br>
<span class='line'>196:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>197:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">checkImage</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$request</span><span style="color: #D24; font-weight: bold">);<br>
<span class='line'>198:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$filename&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">createCacheFilename</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$request</span><span style="color: #D24; font-weight: bold">);<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>199:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>200:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;</span><span style="color: #000">FileResponse</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$filename</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">basename</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$filename</span><span style="color: #D24; font-weight: bold">),&nbsp;</span><span style="color: #000">$request</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">getMeta</span><span style="color: #D24; font-weight: bold">()-&gt;</span><span style="color: #000">getType</span><span style="color: #D24; font-weight: bold">());<br>
</span></span></code></div>
<div class='dead'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>201:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>202:    </span><br>
<span class='line'>203:    </span><br>
<span class='line'>204:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>205:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Renders&nbsp;the&nbsp;image&nbsp;directly&nbsp;to&nbsp;the&nbsp;standard&nbsp;output.<br>
<span class='line'>206:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'>207:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;&nbsp;Request&nbsp;$request&nbsp;The&nbsp;image&nbsp;request<br>
<span class='line'>208:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;ImageStorage&nbsp;Fluent&nbsp;interface<br>
<span class='line'>209:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>210:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">public&nbsp;function&nbsp;</span><span style="color: #000">send</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">Request&nbsp;$request</span><span style="color: #D24; font-weight: bold">)<br>
<span class='line'>211:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>212:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">checkImage</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$request</span><span style="color: #D24; font-weight: bold">);<br>
<span class='line'>213:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$filename&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">createCacheFilename</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$request</span><span style="color: #D24; font-weight: bold">);<br>
<span class='line'>214:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$fp&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">fopen</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$filename</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #080">'r'</span><span style="color: #D24; font-weight: bold">);<br>
<span class='line'>215:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">header</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #080">"Content-type:&nbsp;"&nbsp;</span><span style="color: #D24; font-weight: bold">.&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">getMimeType</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$request</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">getMeta</span><span style="color: #D24; font-weight: bold">()-&gt;</span><span style="color: #000">getType</span><span style="color: #D24; font-weight: bold">()));<br>
<span class='line'>216:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">fpassthru</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$fp</span><span style="color: #D24; font-weight: bold">);<br>
<span class='line'>217:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">fclose</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$fp</span><span style="color: #D24; font-weight: bold">);<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>218:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>219:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">;<br>
</span></span></code></div>
<div class='dead'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>220:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>221:    </span><br>
<span class='line'>222:    </span><br>
<span class='line'>223:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>224:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Checks&nbsp;that&nbsp;the&nbsp;cached&nbsp;version&nbsp;of&nbsp;the&nbsp;image&nbsp;exists&nbsp;and&nbsp;creates&nbsp;it&nbsp;if&nbsp;not.<br>
<span class='line'>225:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'>226:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;&nbsp;Request&nbsp;$request&nbsp;The&nbsp;image&nbsp;request<br>
<span class='line'>227:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;string&nbsp;&nbsp;The&nbsp;file&nbsp;name&nbsp;of&nbsp;the&nbsp;existing&nbsp;cached&nbsp;version&nbsp;of&nbsp;an&nbsp;image<br>
<span class='line'>228:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>229:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">private&nbsp;function&nbsp;</span><span style="color: #000">checkImage</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">Request&nbsp;$request</span><span style="color: #D24; font-weight: bold">)<br>
<span class='line'>230:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>231:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$filename&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">createCacheFilename</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$request</span><span style="color: #D24; font-weight: bold">);<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>232:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>233:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!</span><span style="color: #000">file_exists</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$filename</span><span style="color: #D24; font-weight: bold">))&nbsp;{<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>234:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>235:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$meta&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">$request</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">getMeta</span><span style="color: #D24; font-weight: bold">();<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>236:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>237:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">contains</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$meta</span><span style="color: #D24; font-weight: bold">))&nbsp;{<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>238:    </span><br>
<span class='line'>239:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">//&nbsp;Use&nbsp;another&nbsp;meta<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #999; font-style: italic"><span class='line'>240:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$meta&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;new&nbsp;</span><span style="color: #000">EmptyImage</span><span style="color: #D24; font-weight: bold">();<br>
<span class='line'>241:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$request</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">setMeta</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$meta</span><span style="color: #D24; font-weight: bold">);<br>
<span class='line'>242:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$filename&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">createCacheFilename</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$request</span><span style="color: #D24; font-weight: bold">);<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>243:    </span><br>
<span class='line'>244:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
<span class='line'>245:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>246:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$original&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">original</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$meta</span><span style="color: #D24; font-weight: bold">);<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>247:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>248:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span style="color: #000">$request</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">getCrop</span><span style="color: #D24; font-weight: bold">())&nbsp;{<br>
<span class='line'>249:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$image&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">crop</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$original</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">$request</span><span style="color: #D24; font-weight: bold">);<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>250:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>251:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$image&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">resize</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$original</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">$request</span><span style="color: #D24; font-weight: bold">);<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>252:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>253:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new&nbsp;</span><span style="color: #000">Directory</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">dirname</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$filename</span><span style="color: #D24; font-weight: bold">));<br>
<span class='line'>254:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$image</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">save</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$filename</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">75</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">$meta</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">getType</span><span style="color: #D24; font-weight: bold">());<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>255:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>256:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>257:    </span><br>
<span class='line'>258:    </span><br>
<span class='line'>259:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>260:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;file&nbsp;name&nbsp;of&nbsp;the&nbsp;cached&nbsp;version&nbsp;of&nbsp;the&nbsp;image.<br>
<span class='line'>261:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'>262:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;Request&nbsp;$request<br>
<span class='line'>263:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;string&nbsp;The&nbsp;file&nbsp;name&nbsp;of&nbsp;the&nbsp;cached&nbsp;version&nbsp;of&nbsp;the&nbsp;image<br>
<span class='line'>264:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>265:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">private&nbsp;function&nbsp;</span><span style="color: #000">createCacheFilename</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">Request&nbsp;$request</span><span style="color: #D24; font-weight: bold">)<br>
<span class='line'>266:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>267:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$filePath&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">createFilePath</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$request</span><span style="color: #D24; font-weight: bold">);<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>268:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>269:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #080">"</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">cacheDirectory</span><span style="color: #080">/</span><span style="color: #000">$filePath</span><span style="color: #080">"</span><span style="color: #D24; font-weight: bold">;<br>
</span></span></code></div>
<div class='dead'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>270:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>271:    </span><br>
<span class='line'>272:    </span><br>
<span class='line'>273:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>274:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Crops&nbsp;the&nbsp;given&nbsp;image&nbsp;using&nbsp;the&nbsp;given&nbsp;image&nbsp;request&nbsp;options.<br>
<span class='line'>275:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'>276:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;&nbsp;Image&nbsp;&nbsp;&nbsp;$image&nbsp;&nbsp;&nbsp;The&nbsp;image&nbsp;to&nbsp;resize<br>
<span class='line'>277:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;&nbsp;Request&nbsp;$request&nbsp;The&nbsp;image&nbsp;request<br>
<span class='line'>278:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;Image&nbsp;&nbsp;&nbsp;The&nbsp;image&nbsp;thumbnail<br>
<span class='line'>279:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>280:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">private&nbsp;function&nbsp;</span><span style="color: #000">crop</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">Image&nbsp;$image</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">Request&nbsp;$request</span><span style="color: #D24; font-weight: bold">)<br>
<span class='line'>281:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>282:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span style="color: #000">$request</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">getDimensions</span><span style="color: #D24; font-weight: bold">()&nbsp;===&nbsp;</span><span style="color: #000">Request</span><span style="color: #D24; font-weight: bold">::</span><span style="color: #000">ORIGINAL</span><span style="color: #D24; font-weight: bold">)&nbsp;{<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>283:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>284:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #000">$image</span><span style="color: #D24; font-weight: bold">;<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>285:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
<span class='line'>286:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>287:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;list(</span><span style="color: #000">$width</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">$height</span><span style="color: #D24; font-weight: bold">)&nbsp;=&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">processDimensions</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$request</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">getDimensions</span><span style="color: #D24; font-weight: bold">());<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>288:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>289:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$resizeWidth&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">$width</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'>290:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$resizeHeight&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">$height</span><span style="color: #D24; font-weight: bold">;<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>291:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>292:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$originalWidth&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">$request</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">getMeta</span><span style="color: #D24; font-weight: bold">()-&gt;</span><span style="color: #000">getWidth</span><span style="color: #D24; font-weight: bold">();<br>
<span class='line'>293:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$originalHeight&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">$request</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">getMeta</span><span style="color: #D24; font-weight: bold">()-&gt;</span><span style="color: #000">getHeight</span><span style="color: #D24; font-weight: bold">();<br>
<span class='line'>294:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$originalLandscape&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">$originalWidth&nbsp;</span><span style="color: #D24; font-weight: bold">&gt;&nbsp;</span><span style="color: #000">$originalHeight</span><span style="color: #D24; font-weight: bold">;<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>295:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>296:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$cropLandscape&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">$width&nbsp;</span><span style="color: #D24; font-weight: bold">&gt;&nbsp;</span><span style="color: #000">$height</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'>297:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$equals&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">$width&nbsp;</span><span style="color: #D24; font-weight: bold">===&nbsp;</span><span style="color: #000">$height</span><span style="color: #D24; font-weight: bold">;<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>298:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>299:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span style="color: #000">$originalLandscape</span><span style="color: #D24; font-weight: bold">)&nbsp;{<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>300:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>301:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span style="color: #000">$cropLandscape</span><span style="color: #D24; font-weight: bold">)&nbsp;{<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>302:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>303:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$coefficient&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">$originalHeight&nbsp;</span><span style="color: #D24; font-weight: bold">/&nbsp;</span><span style="color: #000">$height</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'>304:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$scaledWidth&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">round</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$originalWidth&nbsp;</span><span style="color: #D24; font-weight: bold">/&nbsp;</span><span style="color: #000">$coefficient</span><span style="color: #D24; font-weight: bold">);<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>305:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>306:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$left&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">round</span><span style="color: #D24; font-weight: bold">((</span><span style="color: #000">$scaledWidth&nbsp;</span><span style="color: #D24; font-weight: bold">-&nbsp;</span><span style="color: #000">$width</span><span style="color: #D24; font-weight: bold">)&nbsp;/&nbsp;</span><span style="color: #000">2</span><span style="color: #D24; font-weight: bold">);<br>
<span class='line'>307:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$top&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">0</span><span style="color: #D24; font-weight: bold">;<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>308:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>309:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span style="color: #000">$scaledWidth&nbsp;</span><span style="color: #D24; font-weight: bold">&lt;&nbsp;</span><span style="color: #000">$width</span><span style="color: #D24; font-weight: bold">)&nbsp;{<br>
<span class='line'>310:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$coefficient&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">$originalWidth&nbsp;</span><span style="color: #D24; font-weight: bold">/&nbsp;</span><span style="color: #000">$width</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'>311:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$scaledHeight&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">round</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$originalHeight&nbsp;</span><span style="color: #D24; font-weight: bold">/&nbsp;</span><span style="color: #000">$coefficient</span><span style="color: #D24; font-weight: bold">);<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>312:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>313:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$left&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">0</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'>314:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$top&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">round</span><span style="color: #D24; font-weight: bold">((</span><span style="color: #000">$scaledHeight&nbsp;</span><span style="color: #D24; font-weight: bold">-&nbsp;</span><span style="color: #000">$height</span><span style="color: #D24; font-weight: bold">)&nbsp;/&nbsp;</span><span style="color: #000">2</span><span style="color: #D24; font-weight: bold">);<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>315:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
<span class='line'>316:    </span><br>
<span class='line'>317:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br>
<span class='line'>318:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>319:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$coefficient&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">$originalHeight&nbsp;</span><span style="color: #D24; font-weight: bold">/&nbsp;</span><span style="color: #000">$height</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'>320:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$scaledWidth&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">round</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$originalWidth&nbsp;</span><span style="color: #D24; font-weight: bold">/&nbsp;</span><span style="color: #000">$coefficient</span><span style="color: #D24; font-weight: bold">);<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>321:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>322:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$left&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">round</span><span style="color: #D24; font-weight: bold">((</span><span style="color: #000">$scaledWidth&nbsp;</span><span style="color: #D24; font-weight: bold">-&nbsp;</span><span style="color: #000">$width</span><span style="color: #D24; font-weight: bold">)&nbsp;/&nbsp;</span><span style="color: #000">2</span><span style="color: #D24; font-weight: bold">);<br>
<span class='line'>323:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$top&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">0</span><span style="color: #D24; font-weight: bold">;<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>324:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
<span class='line'>325:    </span><br>
<span class='line'>326:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br>
<span class='line'>327:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>328:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span style="color: #000">$cropLandscape&nbsp;</span><span style="color: #D24; font-weight: bold">||&nbsp;</span><span style="color: #000">$equals</span><span style="color: #D24; font-weight: bold">)&nbsp;{<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>329:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>330:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$coefficient&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">$originalWidth&nbsp;</span><span style="color: #D24; font-weight: bold">/&nbsp;</span><span style="color: #000">$width</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'>331:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$scaledHeight&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">round</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$originalHeight&nbsp;</span><span style="color: #D24; font-weight: bold">/&nbsp;</span><span style="color: #000">$coefficient</span><span style="color: #D24; font-weight: bold">);<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>332:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>333:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$left&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">0</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'>334:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$top&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">round</span><span style="color: #D24; font-weight: bold">((</span><span style="color: #000">$scaledHeight&nbsp;</span><span style="color: #D24; font-weight: bold">-&nbsp;</span><span style="color: #000">$height</span><span style="color: #D24; font-weight: bold">)&nbsp;/&nbsp;</span><span style="color: #000">2</span><span style="color: #D24; font-weight: bold">);<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>335:    </span><br>
<span class='line'>336:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br>
<span class='line'>337:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>338:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$coefficient&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">$originalHeight&nbsp;</span><span style="color: #D24; font-weight: bold">/&nbsp;</span><span style="color: #000">$height</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'>339:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$scaledWidth&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">round</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$originalWidth&nbsp;</span><span style="color: #D24; font-weight: bold">/&nbsp;</span><span style="color: #000">$coefficient</span><span style="color: #D24; font-weight: bold">);<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>340:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>341:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$left&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">round</span><span style="color: #D24; font-weight: bold">((</span><span style="color: #000">$scaledWidth&nbsp;</span><span style="color: #D24; font-weight: bold">-&nbsp;</span><span style="color: #000">$width</span><span style="color: #D24; font-weight: bold">)&nbsp;/&nbsp;</span><span style="color: #000">2</span><span style="color: #D24; font-weight: bold">);<br>
<span class='line'>342:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$top&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">0</span><span style="color: #D24; font-weight: bold">;<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>343:    </span><br>
<span class='line'>344:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
<span class='line'>345:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
<span class='line'>346:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>347:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$image</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">resize</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$resizeWidth</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">$resizeHeight</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">Image</span><span style="color: #D24; font-weight: bold">::</span><span style="color: #000">FILL</span><span style="color: #D24; font-weight: bold">);<br>
<span class='line'>348:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$image</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">crop</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$left</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">$top</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">$width</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">$height</span><span style="color: #D24; font-weight: bold">);<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>349:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>350:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #000">$image</span><span style="color: #D24; font-weight: bold">;<br>
</span></span></code></div>
<div class='dead'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>351:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>352:    </span><br>
<span class='line'>353:    </span><br>
<span class='line'>354:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>355:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Resizes&nbsp;the&nbsp;given&nbsp;image&nbsp;to&nbsp;the&nbsp;given&nbsp;dimensions&nbsp;using&nbsp;given&nbsp;flags.<br>
<span class='line'>356:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'>357:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;&nbsp;Image&nbsp;&nbsp;&nbsp;$image&nbsp;&nbsp;&nbsp;The&nbsp;image&nbsp;to&nbsp;resize<br>
<span class='line'>358:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;&nbsp;Request&nbsp;$request&nbsp;The&nbsp;image&nbsp;request<br>
<span class='line'>359:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;Image&nbsp;&nbsp;&nbsp;The&nbsp;image&nbsp;thumbnail<br>
<span class='line'>360:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>361:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">private&nbsp;function&nbsp;</span><span style="color: #000">resize</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">Image&nbsp;$image</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">Request&nbsp;$request</span><span style="color: #D24; font-weight: bold">)<br>
<span class='line'>362:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>363:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span style="color: #000">$request</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">getDimensions</span><span style="color: #D24; font-weight: bold">()&nbsp;===&nbsp;</span><span style="color: #000">Request</span><span style="color: #D24; font-weight: bold">::</span><span style="color: #000">ORIGINAL</span><span style="color: #D24; font-weight: bold">)&nbsp;{<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>364:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>365:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #000">$image</span><span style="color: #D24; font-weight: bold">;<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>366:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
<span class='line'>367:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>368:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;list(</span><span style="color: #000">$width</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">$height</span><span style="color: #D24; font-weight: bold">)&nbsp;=&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">processDimensions</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$request</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">getDimensions</span><span style="color: #D24; font-weight: bold">());<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>369:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>370:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #000">$image</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">resize</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$width</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">$height</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">$request</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">getFlags</span><span style="color: #D24; font-weight: bold">());<br>
</span></span></code></div>
<div class='dead'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>371:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>372:    </span><br>
<span class='line'>373:    </span><br>
<span class='line'>374:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>375:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;part&nbsp;of&nbsp;the&nbsp;image&nbsp;filename&nbsp;relative&nbsp;to&nbsp;the&nbsp;cache&nbsp;directory.<br>
<span class='line'>376:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'>377:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;&nbsp;Request&nbsp;$request&nbsp;The&nbsp;image&nbsp;request<br>
<span class='line'>378:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;string<br>
<span class='line'>379:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>380:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">private&nbsp;function&nbsp;</span><span style="color: #000">createFilePath</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">Request&nbsp;$request</span><span style="color: #D24; font-weight: bold">)<br>
<span class='line'>381:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>382:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$dimensions&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">$request</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">getDimensions</span><span style="color: #D24; font-weight: bold">();<br>
<span class='line'>383:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$flags&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">$request</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">getFlags</span><span style="color: #D24; font-weight: bold">();<br>
<span class='line'>384:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$crop&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;(int)&nbsp;</span><span style="color: #000">$request</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">getCrop</span><span style="color: #D24; font-weight: bold">();<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>385:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>386:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$meta&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">$request</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">getMeta</span><span style="color: #D24; font-weight: bold">();<br>
<span class='line'>387:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$ext&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">getExtension</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$meta</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">getType</span><span style="color: #D24; font-weight: bold">());<br>
<span class='line'>388:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$baseFilePath&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">createCacheDirectoryPath</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$meta</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">getHash</span><span style="color: #D24; font-weight: bold">());<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>389:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>390:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #080">"</span><span style="color: #000">$baseFilePath</span><span style="color: #080">.</span><span style="color: #000">$dimensions</span><span style="color: #080">.</span><span style="color: #000">$flags</span><span style="color: #080">.</span><span style="color: #000">$crop</span><span style="color: #080">.</span><span style="color: #000">$ext</span><span style="color: #080">"</span><span style="color: #D24; font-weight: bold">;<br>
</span></span></code></div>
<div class='dead'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>391:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>392:    </span><br>
<span class='line'>393:    </span><br>
<span class='line'>394:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>395:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Parses&nbsp;the&nbsp;given&nbsp;dimensions&nbsp;string&nbsp;for&nbsp;the&nbsp;image&nbsp;width&nbsp;and&nbsp;height.<br>
<span class='line'>396:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'>397:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;&nbsp;string&nbsp;$dimensions&nbsp;The&nbsp;dimensions&nbsp;string<br>
<span class='line'>398:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;array&nbsp;&nbsp;The&nbsp;width&nbsp;and&nbsp;height&nbsp;of&nbsp;the&nbsp;image&nbsp;in&nbsp;pixels<br>
<span class='line'>399:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>400:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">private&nbsp;function&nbsp;</span><span style="color: #000">processDimensions</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$dimensions</span><span style="color: #D24; font-weight: bold">)<br>
<span class='line'>401:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>402:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span style="color: #000">strpos</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$dimensions</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #080">'x'</span><span style="color: #D24; font-weight: bold">)&nbsp;!==&nbsp;</span><span style="color: #000">FALSE</span><span style="color: #D24; font-weight: bold">)&nbsp;{<br>
<span class='line'>403:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;list(</span><span style="color: #000">$width</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">$height</span><span style="color: #D24; font-weight: bold">)&nbsp;=&nbsp;</span><span style="color: #000">explode</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #080">'x'</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">$dimensions</span><span style="color: #D24; font-weight: bold">);&nbsp;</span><span style="color: #999; font-style: italic">//&nbsp;different&nbsp;dimensions,&nbsp;eg.&nbsp;"210x150"<br>
<span class='line'>404:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$width&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">intval</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$width</span><span style="color: #D24; font-weight: bold">);<br>
<span class='line'>405:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$height&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">intval</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$height</span><span style="color: #D24; font-weight: bold">);<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>406:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>407:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$width&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">intval</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$dimensions</span><span style="color: #D24; font-weight: bold">);&nbsp;</span><span style="color: #999; font-style: italic">//&nbsp;same&nbsp;dimensions,&nbsp;eg.&nbsp;"210"&nbsp;=&gt;&nbsp;210x210<br>
<span class='line'>408:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$height&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">$width</span><span style="color: #D24; font-weight: bold">;<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>409:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
<span class='line'>410:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>411:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;array(</span><span style="color: #000">$width</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">$height</span><span style="color: #D24; font-weight: bold">);<br>
</span></span></code></div>
<div class='dead'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>412:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>413:    </span><br>
<span class='line'>414:    </span><br>
<span class='line'>415:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>416:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;file&nbsp;extension&nbsp;for&nbsp;the&nbsp;given&nbsp;image&nbsp;type.<br>
<span class='line'>417:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'>418:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;&nbsp;integer&nbsp;$type&nbsp;The&nbsp;image&nbsp;type<br>
<span class='line'>419:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;string&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;file&nbsp;extension<br>
<span class='line'>420:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;ImageTypeException<br>
<span class='line'>421:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>422:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">private&nbsp;function&nbsp;</span><span style="color: #000">getExtension</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$type</span><span style="color: #D24; font-weight: bold">)<br>
<span class='line'>423:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>424:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">extensions</span><span style="color: #D24; font-weight: bold">[</span><span style="color: #000">$type</span><span style="color: #D24; font-weight: bold">];<br>
</span></span></code></div>
<div class='dead'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>425:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>426:    </span><br>
<span class='line'>427:    </span><br>
<span class='line'>428:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>429:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Creates&nbsp;the&nbsp;internal&nbsp;directory&nbsp;path&nbsp;from&nbsp;the&nbsp;given&nbsp;hash.<br>
<span class='line'>430:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'>431:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Some&nbsp;special&nbsp;images&nbsp;like&nbsp;the&nbsp;"Image&nbsp;Not&nbsp;Available"&nbsp;image&nbsp;are&nbsp;stored<br>
<span class='line'>432:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;in&nbsp;directories&nbsp;prefixed&nbsp;with&nbsp;an&nbsp;underscore.&nbsp;Those&nbsp;directories&nbsp;are&nbsp;not<br>
<span class='line'>433:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;fragmented&nbsp;to&nbsp;hash&nbsp;based&nbsp;structure.<br>
<span class='line'>434:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'>435:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;&nbsp;string&nbsp;$hash&nbsp;Tha&nbsp;SHA1&nbsp;hash<br>
<span class='line'>436:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;string<br>
<span class='line'>437:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>438:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">private&nbsp;function&nbsp;</span><span style="color: #000">createCacheDirectoryPath</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$hash</span><span style="color: #D24; font-weight: bold">)<br>
<span class='line'>439:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>440:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span style="color: #000">$hash</span><span style="color: #D24; font-weight: bold">{</span><span style="color: #000">0</span><span style="color: #D24; font-weight: bold">}&nbsp;===&nbsp;</span><span style="color: #080">'_'</span><span style="color: #D24; font-weight: bold">)&nbsp;{<br>
<span class='line'>441:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #080">"</span><span style="color: #000">$hash</span><span style="color: #080">/</span><span style="color: #000">$hash</span><span style="color: #080">"</span><span style="color: #D24; font-weight: bold">;<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>442:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
<span class='line'>443:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>444:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #080">"</span><span style="color: #000">$hash</span><span style="color: #D24; font-weight: bold">[</span><span style="color: #000">0</span><span style="color: #D24; font-weight: bold">]</span><span style="color: #000">$hash</span><span style="color: #D24; font-weight: bold">[</span><span style="color: #000">1</span><span style="color: #D24; font-weight: bold">]</span><span style="color: #080">/</span><span style="color: #000">$hash</span><span style="color: #D24; font-weight: bold">[</span><span style="color: #000">2</span><span style="color: #D24; font-weight: bold">]</span><span style="color: #000">$hash</span><span style="color: #D24; font-weight: bold">[</span><span style="color: #000">3</span><span style="color: #D24; font-weight: bold">]</span><span style="color: #080">"&nbsp;</span><span style="color: #D24; font-weight: bold">.&nbsp;</span><span style="color: #080">'/'&nbsp;</span><span style="color: #D24; font-weight: bold">.&nbsp;</span><span style="color: #000">$hash</span><span style="color: #D24; font-weight: bold">;<br>
</span></span></code></div>
<div class='dead'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>445:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>446:    </span><br>
<span class='line'>447:    </span><br>
<span class='line'>448:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>449:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Creates&nbsp;the&nbsp;absolute&nbsp;file&nbsp;name&nbsp;from&nbsp;the&nbsp;given&nbsp;meta&nbsp;information.<br>
<span class='line'>450:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'>451:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;&nbsp;Meta&nbsp;$meta&nbsp;The&nbsp;image&nbsp;meta&nbsp;information<br>
<span class='line'>452:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;string&nbsp;The&nbsp;absolute&nbsp;file&nbsp;name<br>
<span class='line'>453:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>454:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">private&nbsp;function&nbsp;</span><span style="color: #000">createFilename</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">Meta&nbsp;$meta</span><span style="color: #D24; font-weight: bold">)<br>
<span class='line'>455:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>456:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$path&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">createDirectoryPath</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$meta</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">getHash</span><span style="color: #D24; font-weight: bold">());<br>
<span class='line'>457:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$ext&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">getExtension</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$meta</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">getType</span><span style="color: #D24; font-weight: bold">());<br>
<span class='line'>458:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$hash&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">$meta</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">getHash</span><span style="color: #D24; font-weight: bold">();<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>459:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>460:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$filename&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #080">"</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">directory</span><span style="color: #080">/</span><span style="color: #000">$path</span><span style="color: #080">/</span><span style="color: #000">$hash</span><span style="color: #080">.</span><span style="color: #000">$ext</span><span style="color: #080">"</span><span style="color: #D24; font-weight: bold">;<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>461:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>462:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new&nbsp;</span><span style="color: #000">Directory</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">dirname</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$filename</span><span style="color: #D24; font-weight: bold">));<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>463:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>464:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #000">$filename</span><span style="color: #D24; font-weight: bold">;<br>
</span></span></code></div>
<div class='dead'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>465:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>466:    </span><br>
<span class='line'>467:    </span><br>
<span class='line'>468:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>469:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Creates&nbsp;the&nbsp;internal&nbsp;directory&nbsp;path&nbsp;from&nbsp;the&nbsp;given&nbsp;hash.<br>
<span class='line'>470:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'>471:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Some&nbsp;special&nbsp;images&nbsp;like&nbsp;the&nbsp;"Image&nbsp;Not&nbsp;Available"&nbsp;image&nbsp;are&nbsp;stored<br>
<span class='line'>472:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;in&nbsp;directories&nbsp;prefixed&nbsp;with&nbsp;an&nbsp;underscore.&nbsp;Those&nbsp;directories&nbsp;are&nbsp;not<br>
<span class='line'>473:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;fragmented&nbsp;to&nbsp;hash&nbsp;based&nbsp;structure.<br>
<span class='line'>474:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'>475:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;&nbsp;string&nbsp;$hash&nbsp;Tha&nbsp;SHA1&nbsp;hash<br>
<span class='line'>476:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;string<br>
<span class='line'>477:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>478:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">private&nbsp;function&nbsp;</span><span style="color: #000">createDirectoryPath</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$hash</span><span style="color: #D24; font-weight: bold">)<br>
<span class='line'>479:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>480:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span style="color: #000">$hash</span><span style="color: #D24; font-weight: bold">{</span><span style="color: #000">0</span><span style="color: #D24; font-weight: bold">}&nbsp;===&nbsp;</span><span style="color: #080">'_'</span><span style="color: #D24; font-weight: bold">)&nbsp;{<br>
<span class='line'>481:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #000">$hash</span><span style="color: #D24; font-weight: bold">;<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>482:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
<span class='line'>483:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>484:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #080">"</span><span style="color: #000">$hash</span><span style="color: #D24; font-weight: bold">[</span><span style="color: #000">0</span><span style="color: #D24; font-weight: bold">]</span><span style="color: #000">$hash</span><span style="color: #D24; font-weight: bold">[</span><span style="color: #000">1</span><span style="color: #D24; font-weight: bold">]</span><span style="color: #080">/</span><span style="color: #000">$hash</span><span style="color: #D24; font-weight: bold">[</span><span style="color: #000">2</span><span style="color: #D24; font-weight: bold">]</span><span style="color: #000">$hash</span><span style="color: #D24; font-weight: bold">[</span><span style="color: #000">3</span><span style="color: #D24; font-weight: bold">]</span><span style="color: #080">"</span><span style="color: #D24; font-weight: bold">;<br>
</span></span></code></div>
<div class='dead'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>485:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>486:    </span><br>
<span class='line'>487:    </span><br>
<span class='line'>488:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>489:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Reads&nbsp;the&nbsp;image&nbsp;type&nbsp;from&nbsp;the&nbsp;given&nbsp;`$filename`,&nbsp;computes&nbsp;the&nbsp;image&nbsp;hash<br>
<span class='line'>490:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;and&nbsp;store&nbsp;these&nbsp;information&nbsp;in&nbsp;the&nbsp;given&nbsp;`$meta`.<br>
<span class='line'>491:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'>492:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;string&nbsp;$filename&nbsp;The&nbsp;file&nbsp;to&nbsp;read&nbsp;the&nbsp;meta-data&nbsp;from<br>
<span class='line'>493:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;Meta&nbsp;&nbsp;&nbsp;$meta&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;object&nbsp;to&nbsp;store&nbsp;meta-data&nbsp;in<br>
<span class='line'>494:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>495:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">private&nbsp;function&nbsp;</span><span style="color: #000">readMeta</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$filename</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">Meta&nbsp;$meta</span><span style="color: #D24; font-weight: bold">)<br>
<span class='line'>496:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>497:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$info&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">getimagesize</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$filename</span><span style="color: #D24; font-weight: bold">);<br>
<span class='line'>498:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$meta</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">setHash</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">hash</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$filename</span><span style="color: #D24; font-weight: bold">));<br>
<span class='line'>499:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$meta</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">setWidth</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$info</span><span style="color: #D24; font-weight: bold">[</span><span style="color: #000">0</span><span style="color: #D24; font-weight: bold">]);<br>
<span class='line'>500:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$meta</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">setHeight</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$info</span><span style="color: #D24; font-weight: bold">[</span><span style="color: #000">1</span><span style="color: #D24; font-weight: bold">]);<br>
<span class='line'>501:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$meta</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">setType</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$info</span><span style="color: #D24; font-weight: bold">[</span><span style="color: #000">2</span><span style="color: #D24; font-weight: bold">]);<br>
<span class='line'>502:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>503:    </span><br>
<span class='line'>504:    </span><br>
<span class='line'>505:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>506:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Computes&nbsp;the&nbsp;SHA1&nbsp;hash&nbsp;for&nbsp;the&nbsp;given&nbsp;file.<br>
<span class='line'>507:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'>508:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;string&nbsp;$filename&nbsp;The&nbsp;file&nbsp;to&nbsp;compute&nbsp;the&nbsp;hash&nbsp;from<br>
<span class='line'>509:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;string&nbsp;The&nbsp;SHA1&nbsp;hash&nbsp;of&nbsp;a&nbsp;file<br>
<span class='line'>510:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>511:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">private&nbsp;function&nbsp;</span><span style="color: #000">hash</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$filename</span><span style="color: #D24; font-weight: bold">)<br>
<span class='line'>512:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>513:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #000">sha1_file</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$filename</span><span style="color: #D24; font-weight: bold">);<br>
</span></span></code></div>
<div class='dead'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>514:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>515:    </span><br>
<span class='line'>516:    </span><br>
<span class='line'>517:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>518:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;image&nbsp;MIME&nbsp;type&nbsp;according&nbsp;to&nbsp;the&nbsp;given&nbsp;image&nbsp;type.<br>
<span class='line'>519:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'>520:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;integer&nbsp;$imageType&nbsp;Image&nbsp;type<br>
<span class='line'>521:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;string<br>
<span class='line'>522:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>523:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">protected&nbsp;function&nbsp;</span><span style="color: #000">getMimeType</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$imageType</span><span style="color: #D24; font-weight: bold">)<br>
<span class='line'>524:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>525:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">mimeTypes</span><span style="color: #D24; font-weight: bold">[</span><span style="color: #000">$imageType</span><span style="color: #D24; font-weight: bold">];<br>
</span></span></code></div>
<div class='dead'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>526:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>527:    </span><br>
<span class='line'>528:    </span><br>
<span class='line'>529:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>530:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;original&nbsp;stored&nbsp;image&nbsp;filename.<br>
<span class='line'>531:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'>532:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;Meta&nbsp;$meta&nbsp;Image&nbsp;meta&nbsp;information<br>
<span class='line'>533:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;string<br>
<span class='line'>534:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>535:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">public&nbsp;function&nbsp;</span><span style="color: #000">file</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">Meta&nbsp;$meta</span><span style="color: #D24; font-weight: bold">)<br>
<span class='line'>536:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>537:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">createFilename</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$meta</span><span style="color: #D24; font-weight: bold">);<br>
</span></span></code></div>
<div class='dead'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>538:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>539:    </span><br>
<span class='line'>540:    </span><br>
<span class='line'>541:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>542:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;public&nbsp;accessible&nbsp;cache&nbsp;directory&nbsp;URL.<br>
<span class='line'>543:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'>544:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;string<br>
<span class='line'>545:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>546:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">public&nbsp;function&nbsp;</span><span style="color: #000">getBaseUrl</span><span style="color: #D24; font-weight: bold">()<br>
<span class='line'>547:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>548:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">baseUrl</span><span style="color: #D24; font-weight: bold">;<br>
</span></span></code></div>
<div class='dead'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>549:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>550:    </span><br>
<span class='line'>551:    </span><br>
<span class='line'>552:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>553:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Sets&nbsp;the&nbsp;public&nbsp;accessible&nbsp;cache&nbsp;directory&nbsp;URL.<br>
<span class='line'>554:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'>555:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;string&nbsp;$baseUrl<br>
<span class='line'>556:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;$this<br>
<span class='line'>557:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>558:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">protected&nbsp;function&nbsp;</span><span style="color: #000">setBaseUrl</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$baseUrl</span><span style="color: #D24; font-weight: bold">)<br>
<span class='line'>559:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>560:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!</span><span style="color: #000">Strings</span><span style="color: #D24; font-weight: bold">::</span><span style="color: #000">endsWith</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$baseUrl</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #080">'/'</span><span style="color: #D24; font-weight: bold">))&nbsp;{<br>
<span class='line'>561:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$baseUrl&nbsp;</span><span style="color: #D24; font-weight: bold">.=&nbsp;</span><span style="color: #080">'/'</span><span style="color: #D24; font-weight: bold">;<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>562:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>563:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">baseUrl&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">$baseUrl</span><span style="color: #D24; font-weight: bold">;<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>564:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>565:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">;<br>
</span></span></code></div>
<div class='dead'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>566:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>567:    </span><br>
<span class='line'>568:    </span><br>
<span class='line'>569:    </span>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span style="color: #000">rotate</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">Meta&nbsp;$meta</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">$deg&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">90</span><span style="color: #D24; font-weight: bold">)<br>
<span class='line'>570:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>571:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$original&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">createFilename</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$meta</span><span style="color: #D24; font-weight: bold">);<br>
<span class='line'>572:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$backupName&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">cacheDirectory&nbsp;</span><span style="color: #D24; font-weight: bold">.&nbsp;</span><span style="color: #080">'/__rotate-backup'</span><span style="color: #D24; font-weight: bold">;<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>573:    </span><br>
<span class='line'>574:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">//&nbsp;Create&nbsp;rotated&nbsp;image<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #999; font-style: italic"><span class='line'>575:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">copy</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$original</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">$backupName</span><span style="color: #D24; font-weight: bold">);<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>576:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>577:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">exec</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">sprintf</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #080">"convert&nbsp;-rotate&nbsp;</span><span style="color: #000">$deg</span><span style="color: #080">&nbsp;-strip&nbsp;%s&nbsp;%s"</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">$original</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">$backupName</span><span style="color: #D24; font-weight: bold">));<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>578:    </span><br>
<span class='line'>579:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">//&nbsp;Add&nbsp;new&nbsp;rotated&nbsp;image&nbsp;to&nbsp;storage<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #999; font-style: italic"><span class='line'>580:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">add</span><span style="color: #D24; font-weight: bold">(new&nbsp;</span><span style="color: #000">ImageFile</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$backupName</span><span style="color: #D24; font-weight: bold">),&nbsp;</span><span style="color: #000">$meta</span><span style="color: #D24; font-weight: bold">);<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>581:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>582:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">unlink</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$backupName</span><span style="color: #D24; font-weight: bold">);<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>583:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>584:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">;<br>
</span></span></code></div>
<div class='dead'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>585:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>586:    </span><br>
<span class='line'>587:    </span><br>
<span class='line'>588:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>589:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Adds&nbsp;an&nbsp;image&nbsp;from&nbsp;the&nbsp;given&nbsp;file&nbsp;to&nbsp;the&nbsp;storage.<br>
<span class='line'>590:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'>591:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;ImageFile&nbsp;$file&nbsp;The&nbsp;image&nbsp;file&nbsp;to&nbsp;add<br>
<span class='line'>592:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;Meta&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$meta<br>
<span class='line'>593:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;boolean&nbsp;TRUE&nbsp;on&nbsp;success&nbsp;or&nbsp;FALSE&nbsp;on&nbsp;failure<br>
<span class='line'>594:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>595:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">public&nbsp;function&nbsp;</span><span style="color: #000">add</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">ImageFile&nbsp;$file</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">Meta&nbsp;$meta</span><span style="color: #D24; font-weight: bold">)<br>
<span class='line'>596:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>597:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">readMeta</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$file</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">getName</span><span style="color: #D24; font-weight: bold">(),&nbsp;</span><span style="color: #000">$meta</span><span style="color: #D24; font-weight: bold">);<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>598:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>599:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #000">copy</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$file</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">getName</span><span style="color: #D24; font-weight: bold">(),&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">createFilename</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$meta</span><span style="color: #D24; font-weight: bold">));<br>
</span></span></code></div>
<div class='dead'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>600:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>601:    </span><br>
<span class='line'>602:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>603:    </span>}<br>
</span></span></code></div>
</div>
	</div>
		<div>
		<table>
		<tr>
			<td class="number"><small>100 %</small></td>
			<td><div class="bar"><div style="width: 100%"></div></div></td>
			<td><a href="#fragment6" onclick="toggle(this); return false"><span>ImageStore/Files/ImageFile.php</span></a></td>
		</tr>
		</table>

		<div class="code" id="fragment6">
		<div><span class='line'> 1:    </span><code><span style="color: #06B">
<span style="color: #000">&lt;?php<br>
<span class='line'> 2:    </span><br>
<span class='line'> 3:    </span></span><span style="color: #D24; font-weight: bold">namespace&nbsp;</span><span style="color: #000">Rostenkowski</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">ImageStore</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">Files</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'> 4:    </span><br>
<span class='line'> 5:    </span><br>
<span class='line'> 6:    </span>use&nbsp;</span><span style="color: #000">Rostenkowski</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">ImageStore</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">Exceptions</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">ImageFileException</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'> 7:    </span>use&nbsp;</span><span style="color: #000">Rostenkowski</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">ImageStore</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">File</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'> 8:    </span><br>
<span class='line'> 9:    </span></span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>10:    </span>&nbsp;*&nbsp;Simple&nbsp;image&nbsp;file&nbsp;wrapper<br>
<span class='line'>11:    </span>&nbsp;*/<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #999; font-style: italic"><span class='line'>12:    </span></span><span style="color: #D24; font-weight: bold">class&nbsp;</span><span style="color: #000">ImageFile&nbsp;</span><span style="color: #D24; font-weight: bold">implements&nbsp;</span><span style="color: #000">File<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #000"><span class='line'>13:    </span></span><span style="color: #D24; font-weight: bold">{<br>
<span class='line'>14:    </span><br>
<span class='line'>15:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>16:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;The&nbsp;file&nbsp;name<br>
<span class='line'>17:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'>18:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@var&nbsp;string<br>
<span class='line'>19:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>20:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">private&nbsp;</span><span style="color: #000">$name</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'>21:    </span><br>
<span class='line'>22:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>23:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;The&nbsp;image&nbsp;type<br>
<span class='line'>24:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'>25:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@var&nbsp;integer<br>
<span class='line'>26:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>27:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">private&nbsp;</span><span style="color: #000">$type</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'>28:    </span><br>
<span class='line'>29:    </span><br>
<span class='line'>30:    </span>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span style="color: #000">__construct</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$filename</span><span style="color: #D24; font-weight: bold">)<br>
<span class='line'>31:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>32:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$info&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;@</span><span style="color: #000">getimagesize</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$filename</span><span style="color: #D24; font-weight: bold">);&nbsp;</span><span style="color: #999; font-style: italic">//&nbsp;@:&nbsp;will&nbsp;be&nbsp;escalated&nbsp;to&nbsp;exception&nbsp;on&nbsp;failure<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #999; font-style: italic"><span class='line'>33:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #999; font-style: italic"><span class='line'>34:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">if&nbsp;(</span><span style="color: #000">$info&nbsp;</span><span style="color: #D24; font-weight: bold">===&nbsp;</span><span style="color: #000">FALSE</span><span style="color: #D24; font-weight: bold">)&nbsp;{<br>
<span class='line'>35:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;</span><span style="color: #000">ImageFileException</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$filename</span><span style="color: #D24; font-weight: bold">);<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>36:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>37:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">setName</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$filename</span><span style="color: #D24; font-weight: bold">);<br>
<span class='line'>38:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">setType</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$info</span><span style="color: #D24; font-weight: bold">[</span><span style="color: #000">2</span><span style="color: #D24; font-weight: bold">]);<br>
<span class='line'>39:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>40:    </span><br>
<span class='line'>41:    </span><br>
<span class='line'>42:    </span>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span style="color: #000">getType</span><span style="color: #D24; font-weight: bold">()<br>
<span class='line'>43:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>44:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">type</span><span style="color: #D24; font-weight: bold">;<br>
</span></span></code></div>
<div class='dead'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>45:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>46:    </span><br>
<span class='line'>47:    </span><br>
<span class='line'>48:    </span>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span style="color: #000">setType</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$type</span><span style="color: #D24; font-weight: bold">)<br>
<span class='line'>49:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>50:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">type&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">$type</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'>51:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>52:    </span><br>
<span class='line'>53:    </span><br>
<span class='line'>54:    </span>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span style="color: #000">getName</span><span style="color: #D24; font-weight: bold">()<br>
<span class='line'>55:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>56:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">name</span><span style="color: #D24; font-weight: bold">;<br>
</span></span></code></div>
<div class='dead'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>57:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>58:    </span><br>
<span class='line'>59:    </span><br>
<span class='line'>60:    </span>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span style="color: #000">setName</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$name</span><span style="color: #D24; font-weight: bold">)<br>
<span class='line'>61:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>62:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">name&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">$name</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'>63:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>64:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>65:    </span>}<br>
</span></span></code></div>
</div>
	</div>
		<div>
		<table>
		<tr class='light'>
			<td class="number"><small>100 %</small></td>
			<td><div class="bar"><div style="width: 100%"></div></div></td>
			<td><a href="#fragment7" onclick="toggle(this); return false"><span>ImageStore/Storage.php</span></a></td>
		</tr>
		</table>

		<div class="code" id="fragment7">
		<div><span class='line'> 1:    </span><code><span style="color: #06B">
<span style="color: #000">&lt;?php<br>
<span class='line'> 2:    </span><br>
<span class='line'> 3:    </span></span><span style="color: #D24; font-weight: bold">namespace&nbsp;</span><span style="color: #000">Rostenkowski</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">ImageStore</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'> 4:    </span><br>
<span class='line'> 5:    </span><br>
<span class='line'> 6:    </span>use&nbsp;</span><span style="color: #000">Nette</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">Http</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">FileUpload</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'> 7:    </span><br>
<span class='line'> 8:    </span></span><span style="color: #999; font-style: italic">/**<br>
<span class='line'> 9:    </span>&nbsp;*&nbsp;Image&nbsp;Storage&nbsp;Interface<br>
<span class='line'>10:    </span>&nbsp;*/<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #999; font-style: italic"><span class='line'>11:    </span></span><span style="color: #D24; font-weight: bold">interface&nbsp;</span><span style="color: #000">Storage<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #000"><span class='line'>12:    </span></span><span style="color: #D24; font-weight: bold">{<br>
<span class='line'>13:    </span><br>
<span class='line'>14:    </span><br>
<span class='line'>15:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>16:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;TRUE&nbsp;if&nbsp;the&nbsp;storage&nbsp;contains&nbsp;the&nbsp;given&nbsp;image.<br>
<span class='line'>17:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'>18:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;Meta&nbsp;$meta<br>
<span class='line'>19:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;boolean<br>
<span class='line'>20:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>21:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">public&nbsp;function&nbsp;</span><span style="color: #000">contains</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">Meta&nbsp;$meta</span><span style="color: #D24; font-weight: bold">);<br>
<span class='line'>22:    </span><br>
<span class='line'>23:    </span><br>
<span class='line'>24:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>25:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;requested&nbsp;image&nbsp;encapsulated&nbsp;in&nbsp;a&nbsp;HTTP&nbsp;response&nbsp;object.<br>
<span class='line'>26:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'>27:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;&nbsp;Request&nbsp;$request<br>
<span class='line'>28:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;IResponse<br>
<span class='line'>29:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>30:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">public&nbsp;function&nbsp;</span><span style="color: #000">download</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">Request&nbsp;$request</span><span style="color: #D24; font-weight: bold">);<br>
<span class='line'>31:    </span><br>
<span class='line'>32:    </span><br>
<span class='line'>33:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>34:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;requested&nbsp;image&nbsp;object.<br>
<span class='line'>35:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'>36:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;Request&nbsp;$request<br>
<span class='line'>37:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;mixed<br>
<span class='line'>38:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>39:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">public&nbsp;function&nbsp;</span><span style="color: #000">fetch</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">Request&nbsp;$request</span><span style="color: #D24; font-weight: bold">);<br>
<span class='line'>40:    </span><br>
<span class='line'>41:    </span><br>
<span class='line'>42:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>43:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Creates&nbsp;the&nbsp;URL&nbsp;of&nbsp;the&nbsp;requested&nbsp;image&nbsp;thumbnail.<br>
<span class='line'>44:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'>45:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;&nbsp;Request&nbsp;$request<br>
<span class='line'>46:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;string<br>
<span class='line'>47:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>48:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">public&nbsp;function&nbsp;</span><span style="color: #000">link</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">Request&nbsp;$request</span><span style="color: #D24; font-weight: bold">);<br>
<span class='line'>49:    </span><br>
<span class='line'>50:    </span><br>
<span class='line'>51:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>52:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Fetches&nbsp;the&nbsp;original&nbsp;stored&nbsp;image.<br>
<span class='line'>53:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'>54:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;Meta&nbsp;$meta<br>
<span class='line'>55:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;Image<br>
<span class='line'>56:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>57:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">public&nbsp;function&nbsp;</span><span style="color: #000">original</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">Meta&nbsp;$meta</span><span style="color: #D24; font-weight: bold">);<br>
<span class='line'>58:    </span><br>
<span class='line'>59:    </span><br>
<span class='line'>60:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>61:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Removes&nbsp;the&nbsp;requested&nbsp;image&nbsp;from&nbsp;the&nbsp;storage.<br>
<span class='line'>62:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'>63:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;Meta&nbsp;$meta<br>
<span class='line'>64:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;void<br>
<span class='line'>65:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>66:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">public&nbsp;function&nbsp;</span><span style="color: #000">remove</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">Meta&nbsp;$meta</span><span style="color: #D24; font-weight: bold">);<br>
<span class='line'>67:    </span><br>
<span class='line'>68:    </span><br>
<span class='line'>69:    </span>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span style="color: #000">rotate</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">Meta&nbsp;$meta</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">$deg&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">90</span><span style="color: #D24; font-weight: bold">);<br>
<span class='line'>70:    </span><br>
<span class='line'>71:    </span><br>
<span class='line'>72:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>73:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Renders&nbsp;the&nbsp;requested&nbsp;image&nbsp;to&nbsp;the&nbsp;standard&nbsp;output.<br>
<span class='line'>74:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'>75:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;&nbsp;Request&nbsp;$request<br>
<span class='line'>76:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;void<br>
<span class='line'>77:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>78:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">public&nbsp;function&nbsp;</span><span style="color: #000">send</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">Request&nbsp;$request</span><span style="color: #D24; font-weight: bold">);<br>
<span class='line'>79:    </span><br>
<span class='line'>80:    </span><br>
<span class='line'>81:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>82:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Uploads&nbsp;an&nbsp;image&nbsp;to&nbsp;the&nbsp;storage&nbsp;and&nbsp;store&nbsp;it's&nbsp;meta&nbsp;information&nbsp;in&nbsp;the&nbsp;given&nbsp;image&nbsp;entity.<br>
<span class='line'>83:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'>84:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;FileUpload&nbsp;$file<br>
<span class='line'>85:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;Meta&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$meta<br>
<span class='line'>86:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;void<br>
<span class='line'>87:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>88:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">public&nbsp;function&nbsp;</span><span style="color: #000">upload</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">FileUpload&nbsp;$file</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">Meta&nbsp;$meta</span><span style="color: #D24; font-weight: bold">);<br>
<span class='line'>89:    </span><br>
<span class='line'>90:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>91:    </span>}<br>
</span></span></code></div>
</div>
	</div>
		<div>
		<table>
		<tr>
			<td class="number"><small>100 %</small></td>
			<td><div class="bar"><div style="width: 100%"></div></div></td>
			<td><a href="#fragment8" onclick="toggle(this); return false"><span>ImageStore/Entity/ImageEntity.php</span></a></td>
		</tr>
		</table>

		<div class="code" id="fragment8">
		<div><span class='line'>  1:    </span><code><span style="color: #06B">
<span style="color: #000">&lt;?php<br>
<span class='line'>  2:    </span><br>
<span class='line'>  3:    </span></span><span style="color: #D24; font-weight: bold">namespace&nbsp;</span><span style="color: #000">Rostenkowski</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">ImageStore</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">Entity</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'>  4:    </span><br>
<span class='line'>  5:    </span><br>
<span class='line'>  6:    </span>use&nbsp;</span><span style="color: #000">Nette</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">Utils</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">Image</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'>  7:    </span>use&nbsp;</span><span style="color: #000">Nette</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">Utils</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">Strings</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'>  8:    </span>use&nbsp;</span><span style="color: #000">Rostenkowski</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">ImageStore</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">Exceptions</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">HashException</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'>  9:    </span>use&nbsp;</span><span style="color: #000">Rostenkowski</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">ImageStore</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">Exceptions</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">ImageTypeException</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'> 10:    </span>use&nbsp;</span><span style="color: #000">Rostenkowski</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">ImageStore</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">Meta</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'> 11:    </span><br>
<span class='line'> 12:    </span></span><span style="color: #999; font-style: italic">/**<br>
<span class='line'> 13:    </span>&nbsp;*&nbsp;Basic&nbsp;implementation&nbsp;of&nbsp;the&nbsp;image&nbsp;meta&nbsp;information&nbsp;as&nbsp;Doctrine&nbsp;entity.<br>
<span class='line'> 14:    </span>&nbsp;*<br>
<span class='line'> 15:    </span>&nbsp;*&nbsp;@ORM\MappedSuperClass<br>
<span class='line'> 16:    </span>&nbsp;*/<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #999; font-style: italic"><span class='line'> 17:    </span></span><span style="color: #D24; font-weight: bold">class&nbsp;</span><span style="color: #000">ImageEntity&nbsp;</span><span style="color: #D24; font-weight: bold">implements&nbsp;</span><span style="color: #000">Meta<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #000"><span class='line'> 18:    </span></span><span style="color: #D24; font-weight: bold">{<br>
<span class='line'> 19:    </span><br>
<span class='line'> 20:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'> 21:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;SHA1&nbsp;hash&nbsp;of&nbsp;the&nbsp;original&nbsp;image<br>
<span class='line'> 22:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@ORM\Column(length=40,&nbsp;nullable=true)<br>
<span class='line'> 23:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'> 24:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@var&nbsp;string<br>
<span class='line'> 25:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'> 26:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">private&nbsp;</span><span style="color: #000">$hash</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'> 27:    </span><br>
<span class='line'> 28:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'> 29:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Original&nbsp;image&nbsp;type&nbsp;as&nbsp;defined&nbsp;in&nbsp;the&nbsp;`Image`&nbsp;class&nbsp;constants&nbsp;`JPEG`,&nbsp;`GIF`&nbsp;and&nbsp;`PNG`.<br>
<span class='line'> 30:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@ORM\Column(type="integer",&nbsp;nullable=true)<br>
<span class='line'> 31:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'> 32:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@var&nbsp;integer<br>
<span class='line'> 33:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'> 34:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">private&nbsp;</span><span style="color: #000">$type</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'> 35:    </span><br>
<span class='line'> 36:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'> 37:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@ORM\Column(type="integer",&nbsp;nullable=true)<br>
<span class='line'> 38:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'> 39:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@var&nbsp;integer<br>
<span class='line'> 40:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'> 41:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">private&nbsp;</span><span style="color: #000">$width</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'> 42:    </span><br>
<span class='line'> 43:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'> 44:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@ORM\Column(type="integer",&nbsp;nullable=true)<br>
<span class='line'> 45:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'> 46:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@var&nbsp;integer<br>
<span class='line'> 47:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'> 48:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">private&nbsp;</span><span style="color: #000">$height</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'> 49:    </span><br>
<span class='line'> 50:    </span><br>
<span class='line'> 51:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'> 52:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;string<br>
<span class='line'> 53:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'> 54:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">public&nbsp;function&nbsp;</span><span style="color: #000">getHash</span><span style="color: #D24; font-weight: bold">()<br>
<span class='line'> 55:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'> 56:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">hash</span><span style="color: #D24; font-weight: bold">;<br>
</span></span></code></div>
<div class='dead'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'> 57:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'> 58:    </span><br>
<span class='line'> 59:    </span><br>
<span class='line'> 60:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'> 61:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;&nbsp;string&nbsp;$hash<br>
<span class='line'> 62:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;ImageEntity<br>
<span class='line'> 63:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'> 64:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">public&nbsp;function&nbsp;</span><span style="color: #000">setHash</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$hash</span><span style="color: #D24; font-weight: bold">)<br>
<span class='line'> 65:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'> 66:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">hash&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">checkHash</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$hash</span><span style="color: #D24; font-weight: bold">);<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'> 67:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'> 68:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">;<br>
</span></span></code></div>
<div class='dead'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'> 69:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'> 70:    </span><br>
<span class='line'> 71:    </span><br>
<span class='line'> 72:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'> 73:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;integer<br>
<span class='line'> 74:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'> 75:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">public&nbsp;function&nbsp;</span><span style="color: #000">getType</span><span style="color: #D24; font-weight: bold">()<br>
<span class='line'> 76:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'> 77:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">type</span><span style="color: #D24; font-weight: bold">;<br>
</span></span></code></div>
<div class='dead'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'> 78:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'> 79:    </span><br>
<span class='line'> 80:    </span><br>
<span class='line'> 81:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'> 82:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Checks&nbsp;that&nbsp;the&nbsp;given&nbsp;string&nbsp;is&nbsp;valid&nbsp;SHA1&nbsp;hash&nbsp;and&nbsp;normalizes&nbsp;it&nbsp;to&nbsp;lower&nbsp;case.<br>
<span class='line'> 83:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'> 84:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;&nbsp;string&nbsp;$hash&nbsp;Image&nbsp;hash&nbsp;to&nbsp;validate<br>
<span class='line'> 85:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;HashException&nbsp;If&nbsp;the&nbsp;hash&nbsp;is&nbsp;not&nbsp;valid&nbsp;image&nbsp;hash<br>
<span class='line'> 86:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;string&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;valid&nbsp;image&nbsp;hash<br>
<span class='line'> 87:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'> 88:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">private&nbsp;function&nbsp;</span><span style="color: #000">checkHash</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$hash</span><span style="color: #D24; font-weight: bold">)<br>
<span class='line'> 89:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'> 90:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!</span><span style="color: #000">is_string</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$hash</span><span style="color: #D24; font-weight: bold">))&nbsp;{<br>
<span class='line'> 91:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;</span><span style="color: #000">HashException</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$hash</span><span style="color: #D24; font-weight: bold">);<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'> 92:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'> 93:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$hash&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">Strings</span><span style="color: #D24; font-weight: bold">::</span><span style="color: #000">lower</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$hash</span><span style="color: #D24; font-weight: bold">);<br>
<span class='line'> 94:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!</span><span style="color: #000">preg_match</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #080">'/^[0-9a-f]{40}$/'</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">$hash</span><span style="color: #D24; font-weight: bold">))&nbsp;{<br>
<span class='line'> 95:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;</span><span style="color: #000">HashException</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$hash</span><span style="color: #D24; font-weight: bold">);<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'> 96:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
<span class='line'> 97:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'> 98:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #000">$hash</span><span style="color: #D24; font-weight: bold">;<br>
</span></span></code></div>
<div class='dead'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'> 99:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>100:    </span><br>
<span class='line'>101:    </span><br>
<span class='line'>102:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>103:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;&nbsp;integer&nbsp;$type<br>
<span class='line'>104:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;ImageEntity<br>
<span class='line'>105:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>106:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">public&nbsp;function&nbsp;</span><span style="color: #000">setType</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$type</span><span style="color: #D24; font-weight: bold">)<br>
<span class='line'>107:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>108:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">type&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">checkType</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$type</span><span style="color: #D24; font-weight: bold">);<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>109:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>110:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">;<br>
</span></span></code></div>
<div class='dead'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>111:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>112:    </span><br>
<span class='line'>113:    </span><br>
<span class='line'>114:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>115:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Checks&nbsp;the&nbsp;given&nbsp;image&nbsp;type&nbsp;to&nbsp;be&nbsp;one&nbsp;of&nbsp;the&nbsp;supported&nbsp;types.<br>
<span class='line'>116:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'>117:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;&nbsp;integer&nbsp;$type<br>
<span class='line'>118:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;integer<br>
<span class='line'>119:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;ImageTypeException<br>
<span class='line'>120:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>121:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">private&nbsp;function&nbsp;</span><span style="color: #000">checkType</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$type</span><span style="color: #D24; font-weight: bold">)<br>
<span class='line'>122:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>123:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!</span><span style="color: #000">in_array</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$type</span><span style="color: #D24; font-weight: bold">,&nbsp;array(</span><span style="color: #000">Image</span><span style="color: #D24; font-weight: bold">::</span><span style="color: #000">JPEG</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">Image</span><span style="color: #D24; font-weight: bold">::</span><span style="color: #000">PNG</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">Image</span><span style="color: #D24; font-weight: bold">::</span><span style="color: #000">GIF</span><span style="color: #D24; font-weight: bold">),&nbsp;</span><span style="color: #000">TRUE</span><span style="color: #D24; font-weight: bold">))&nbsp;{<br>
<span class='line'>124:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;</span><span style="color: #000">ImageTypeException</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$type</span><span style="color: #D24; font-weight: bold">);<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>125:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
<span class='line'>126:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>127:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #000">$type</span><span style="color: #D24; font-weight: bold">;<br>
</span></span></code></div>
<div class='dead'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>128:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>129:    </span><br>
<span class='line'>130:    </span><br>
<span class='line'>131:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>132:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;integer<br>
<span class='line'>133:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>134:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">public&nbsp;function&nbsp;</span><span style="color: #000">getHeight</span><span style="color: #D24; font-weight: bold">()<br>
<span class='line'>135:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>136:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">height</span><span style="color: #D24; font-weight: bold">;<br>
</span></span></code></div>
<div class='dead'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>137:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>138:    </span><br>
<span class='line'>139:    </span><br>
<span class='line'>140:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>141:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;integer&nbsp;$height<br>
<span class='line'>142:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>143:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">public&nbsp;function&nbsp;</span><span style="color: #000">setHeight</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$height</span><span style="color: #D24; font-weight: bold">)<br>
<span class='line'>144:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>145:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">height&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">$height</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'>146:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>147:    </span><br>
<span class='line'>148:    </span><br>
<span class='line'>149:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>150:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;integer<br>
<span class='line'>151:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>152:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">public&nbsp;function&nbsp;</span><span style="color: #000">getWidth</span><span style="color: #D24; font-weight: bold">()<br>
<span class='line'>153:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>154:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">width</span><span style="color: #D24; font-weight: bold">;<br>
</span></span></code></div>
<div class='dead'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>155:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>156:    </span><br>
<span class='line'>157:    </span><br>
<span class='line'>158:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>159:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;integer&nbsp;$width<br>
<span class='line'>160:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>161:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">public&nbsp;function&nbsp;</span><span style="color: #000">setWidth</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$width</span><span style="color: #D24; font-weight: bold">)<br>
<span class='line'>162:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>163:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">width&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">$width</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'>164:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
<span class='line'>165:    </span>}<br>
</span></span></code></div>
</div>
	</div>
		<div>
		<table>
		<tr>
			<td class="number"><small>100 %</small></td>
			<td><div class="bar"><div style="width: 100%"></div></div></td>
			<td><a href="#fragment9" onclick="toggle(this); return false"><span>ImageStore/Entity/EmptyImage.php</span></a></td>
		</tr>
		</table>

		<div class="code" id="fragment9">
		<div><span class='line'> 1:    </span><code><span style="color: #06B">
<span style="color: #000">&lt;?php<br>
<span class='line'> 2:    </span><br>
<span class='line'> 3:    </span></span><span style="color: #D24; font-weight: bold">namespace&nbsp;</span><span style="color: #000">Rostenkowski</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">ImageStore</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">Entity</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'> 4:    </span><br>
<span class='line'> 5:    </span><br>
<span class='line'> 6:    </span>use&nbsp;</span><span style="color: #000">Nette</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">Utils</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">Image</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'> 7:    </span>use&nbsp;</span><span style="color: #000">Rostenkowski</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">ImageStore</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">Meta</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'> 8:    </span><br>
<span class='line'> 9:    </span></span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>10:    </span>&nbsp;*&nbsp;"Image&nbsp;not&nbsp;found"&nbsp;entity<br>
<span class='line'>11:    </span>&nbsp;*/<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #999; font-style: italic"><span class='line'>12:    </span></span><span style="color: #D24; font-weight: bold">class&nbsp;</span><span style="color: #000">EmptyImage&nbsp;</span><span style="color: #D24; font-weight: bold">implements&nbsp;</span><span style="color: #000">Meta<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #000"><span class='line'>13:    </span></span><span style="color: #D24; font-weight: bold">{<br>
<span class='line'>14:    </span><br>
<span class='line'>15:    </span>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span style="color: #000">getHash</span><span style="color: #D24; font-weight: bold">()<br>
<span class='line'>16:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>17:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #080">'_empty'</span><span style="color: #D24; font-weight: bold">;<br>
</span></span></code></div>
<div class='dead'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>18:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>19:    </span><br>
<span class='line'>20:    </span><br>
<span class='line'>21:    </span>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span style="color: #000">getType</span><span style="color: #D24; font-weight: bold">()<br>
<span class='line'>22:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>23:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #000">Image</span><span style="color: #D24; font-weight: bold">::</span><span style="color: #000">PNG</span><span style="color: #D24; font-weight: bold">;<br>
</span></span></code></div>
<div class='dead'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>24:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>25:    </span><br>
<span class='line'>26:    </span><br>
<span class='line'>27:    </span>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span style="color: #000">setHash</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$hash</span><span style="color: #D24; font-weight: bold">)<br>
<span class='line'>28:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>29:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;\</span><span style="color: #000">LogicException</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #080">'Unavailable&nbsp;image&nbsp;hash&nbsp;cannot&nbsp;be&nbsp;changed.'</span><span style="color: #D24; font-weight: bold">);<br>
</span></span></code></div>
<div class='dead'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>30:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>31:    </span><br>
<span class='line'>32:    </span><br>
<span class='line'>33:    </span>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span style="color: #000">setType</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$type</span><span style="color: #D24; font-weight: bold">)<br>
<span class='line'>34:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>35:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;\</span><span style="color: #000">LogicException</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #080">'Unavailable&nbsp;image&nbsp;hash&nbsp;cannot&nbsp;be&nbsp;changed.'</span><span style="color: #D24; font-weight: bold">);<br>
</span></span></code></div>
<div class='dead'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>36:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>37:    </span><br>
<span class='line'>38:    </span><br>
<span class='line'>39:    </span>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span style="color: #000">getHeight</span><span style="color: #D24; font-weight: bold">()<br>
<span class='line'>40:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>41:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #000">1080</span><span style="color: #D24; font-weight: bold">;<br>
</span></span></code></div>
<div class='dead'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>42:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>43:    </span><br>
<span class='line'>44:    </span><br>
<span class='line'>45:    </span>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span style="color: #000">getWidth</span><span style="color: #D24; font-weight: bold">()<br>
<span class='line'>46:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>47:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #000">1920</span><span style="color: #D24; font-weight: bold">;<br>
</span></span></code></div>
<div class='dead'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>48:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>49:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>50:    </span>}<br>
</span></span></code></div>
</div>
	</div>
		<div>
		<table>
		<tr class='light'>
			<td class="number"><small>100 %</small></td>
			<td><div class="bar"><div style="width: 100%"></div></div></td>
			<td><a href="#fragment10" onclick="toggle(this); return false"><span>ImageStore/Exceptions/InvalidCacheDirectoryException.php</span></a></td>
		</tr>
		</table>

		<div class="code" id="fragment10">
		<div><span class='line'> 1:    </span><code><span style="color: #06B">
<span style="color: #000">&lt;?php<br>
<span class='line'> 2:    </span><br>
<span class='line'> 3:    </span></span><span style="color: #D24; font-weight: bold">namespace&nbsp;</span><span style="color: #000">Rostenkowski</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">ImageStore</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">Exceptions</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'> 4:    </span><br>
<span class='line'> 5:    </span><br>
<span class='line'> 6:    </span>use&nbsp;</span><span style="color: #000">InvalidArgumentException</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'> 7:    </span><br>
<span class='line'> 8:    </span></span><span style="color: #999; font-style: italic">/**<br>
<span class='line'> 9:    </span>&nbsp;*&nbsp;Invalid&nbsp;cache&nbsp;directory&nbsp;exception<br>
<span class='line'>10:    </span>&nbsp;*<br>
<span class='line'>11:    </span>&nbsp;*&nbsp;It's&nbsp;thrown&nbsp;when&nbsp;user&nbsp;attempts&nbsp;to&nbsp;use&nbsp;the&nbsp;same&nbsp;directory&nbsp;for&nbsp;the&nbsp;storage&nbsp;AND&nbsp;the&nbsp;cache.<br>
<span class='line'>12:    </span>&nbsp;*/<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #999; font-style: italic"><span class='line'>13:    </span></span><span style="color: #D24; font-weight: bold">class&nbsp;</span><span style="color: #000">InvalidCacheDirectoryException&nbsp;</span><span style="color: #D24; font-weight: bold">extends&nbsp;</span><span style="color: #000">InvalidArgumentException<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #000"><span class='line'>14:    </span></span><span style="color: #D24; font-weight: bold">{<br>
<span class='line'>15:    </span><br>
<span class='line'>16:    </span><br>
<span class='line'>17:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>18:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;string&nbsp;$directory<br>
<span class='line'>19:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>20:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">public&nbsp;function&nbsp;</span><span style="color: #000">__construct</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$directory</span><span style="color: #D24; font-weight: bold">)<br>
<span class='line'>21:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>22:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">parent</span><span style="color: #D24; font-weight: bold">::</span><span style="color: #000">__construct</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">sprintf</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #080">'You&nbsp;cannot&nbsp;use&nbsp;the&nbsp;same&nbsp;directory&nbsp;for&nbsp;the&nbsp;image&nbsp;cache&nbsp;as&nbsp;for&nbsp;the&nbsp;storage.&nbsp;Path:&nbsp;(%s)'</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">var_export</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$directory</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">TRUE</span><span style="color: #D24; font-weight: bold">)));<br>
<span class='line'>23:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>24:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>25:    </span>}<br>
</span></span></code></div>
</div>
	</div>
		<div>
		<table>
		<tr class='light'>
			<td class="number"><small>100 %</small></td>
			<td><div class="bar"><div style="width: 100%"></div></div></td>
			<td><a href="#fragment11" onclick="toggle(this); return false"><span>ImageStore/Exceptions/ImageFileException.php</span></a></td>
		</tr>
		</table>

		<div class="code" id="fragment11">
		<div><span class='line'> 1:    </span><code><span style="color: #06B">
<span style="color: #000">&lt;?php<br>
<span class='line'> 2:    </span><br>
<span class='line'> 3:    </span></span><span style="color: #D24; font-weight: bold">namespace&nbsp;</span><span style="color: #000">Rostenkowski</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">ImageStore</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">Exceptions</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'> 4:    </span><br>
<span class='line'> 5:    </span><br>
<span class='line'> 6:    </span>use&nbsp;</span><span style="color: #000">InvalidArgumentException</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'> 7:    </span><br>
<span class='line'> 8:    </span></span><span style="color: #999; font-style: italic">/**<br>
<span class='line'> 9:    </span>&nbsp;*&nbsp;Invalid&nbsp;image&nbsp;type&nbsp;exception<br>
<span class='line'>10:    </span>&nbsp;*/<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #999; font-style: italic"><span class='line'>11:    </span></span><span style="color: #D24; font-weight: bold">class&nbsp;</span><span style="color: #000">ImageFileException&nbsp;</span><span style="color: #D24; font-weight: bold">extends&nbsp;</span><span style="color: #000">InvalidArgumentException<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #000"><span class='line'>12:    </span></span><span style="color: #D24; font-weight: bold">{<br>
<span class='line'>13:    </span><br>
<span class='line'>14:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>15:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;string&nbsp;$filename<br>
<span class='line'>16:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>17:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">public&nbsp;function&nbsp;</span><span style="color: #000">__construct</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$filename</span><span style="color: #D24; font-weight: bold">)<br>
<span class='line'>18:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>19:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">parent</span><span style="color: #D24; font-weight: bold">::</span><span style="color: #000">__construct</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">sprintf</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #080">'File&nbsp;%s&nbsp;does&nbsp;not&nbsp;exist&nbsp;or&nbsp;it&nbsp;is&nbsp;not&nbsp;an&nbsp;image.'</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">var_export</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$filename</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">TRUE</span><span style="color: #D24; font-weight: bold">)));<br>
<span class='line'>20:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>21:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>22:    </span>}<br>
</span></span></code></div>
</div>
	</div>
		<div>
		<table>
		<tr>
			<td class="number"><small>100 %</small></td>
			<td><div class="bar"><div style="width: 100%"></div></div></td>
			<td><a href="#fragment12" onclick="toggle(this); return false"><span>ImageStore/Exceptions/HashException.php</span></a></td>
		</tr>
		</table>

		<div class="code" id="fragment12">
		<div><span class='line'> 1:    </span><code><span style="color: #06B">
<span style="color: #000">&lt;?php<br>
<span class='line'> 2:    </span><br>
<span class='line'> 3:    </span></span><span style="color: #D24; font-weight: bold">namespace&nbsp;</span><span style="color: #000">Rostenkowski</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">ImageStore</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">Exceptions</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'> 4:    </span><br>
<span class='line'> 5:    </span><br>
<span class='line'> 6:    </span>use&nbsp;</span><span style="color: #000">Exception</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'> 7:    </span><br>
<span class='line'> 8:    </span></span><span style="color: #999; font-style: italic">/**<br>
<span class='line'> 9:    </span>&nbsp;*&nbsp;Invalid&nbsp;hash&nbsp;exception<br>
<span class='line'>10:    </span>&nbsp;*/<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #999; font-style: italic"><span class='line'>11:    </span></span><span style="color: #D24; font-weight: bold">class&nbsp;</span><span style="color: #000">HashException&nbsp;</span><span style="color: #D24; font-weight: bold">extends&nbsp;</span><span style="color: #000">Exception<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #000"><span class='line'>12:    </span></span><span style="color: #D24; font-weight: bold">{<br>
<span class='line'>13:    </span><br>
<span class='line'>14:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>15:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;string&nbsp;$hash<br>
<span class='line'>16:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>17:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">public&nbsp;function&nbsp;</span><span style="color: #000">__construct</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$hash</span><span style="color: #D24; font-weight: bold">)<br>
<span class='line'>18:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>19:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$message&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">sprintf</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #080">'The&nbsp;image&nbsp;hash&nbsp;is&nbsp;invalid.&nbsp;It&nbsp;is&nbsp;required&nbsp;to&nbsp;be&nbsp;a&nbsp;SHA1&nbsp;hash&nbsp;but&nbsp;%s&nbsp;given.'</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">var_export</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$hash</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">TRUE</span><span style="color: #D24; font-weight: bold">));<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>20:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>21:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">parent</span><span style="color: #D24; font-weight: bold">::</span><span style="color: #000">__construct</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$message</span><span style="color: #D24; font-weight: bold">);<br>
<span class='line'>22:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>23:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>24:    </span>}<br>
</span></span></code></div>
</div>
	</div>
		<div>
		<table>
		<tr>
			<td class="number"><small>100 %</small></td>
			<td><div class="bar"><div style="width: 100%"></div></div></td>
			<td><a href="#fragment13" onclick="toggle(this); return false"><span>ImageStore/Exceptions/ImageTypeException.php</span></a></td>
		</tr>
		</table>

		<div class="code" id="fragment13">
		<div><span class='line'> 1:    </span><code><span style="color: #06B">
<span style="color: #000">&lt;?php<br>
<span class='line'> 2:    </span><br>
<span class='line'> 3:    </span></span><span style="color: #D24; font-weight: bold">namespace&nbsp;</span><span style="color: #000">Rostenkowski</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">ImageStore</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">Exceptions</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'> 4:    </span><br>
<span class='line'> 5:    </span><br>
<span class='line'> 6:    </span>use&nbsp;</span><span style="color: #000">InvalidArgumentException</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'> 7:    </span><br>
<span class='line'> 8:    </span></span><span style="color: #999; font-style: italic">/**<br>
<span class='line'> 9:    </span>&nbsp;*&nbsp;Invalid&nbsp;image&nbsp;type&nbsp;exception<br>
<span class='line'>10:    </span>&nbsp;*/<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #999; font-style: italic"><span class='line'>11:    </span></span><span style="color: #D24; font-weight: bold">class&nbsp;</span><span style="color: #000">ImageTypeException&nbsp;</span><span style="color: #D24; font-weight: bold">extends&nbsp;</span><span style="color: #000">InvalidArgumentException<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #000"><span class='line'>12:    </span></span><span style="color: #D24; font-weight: bold">{<br>
<span class='line'>13:    </span><br>
<span class='line'>14:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>15:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;integer&nbsp;$type<br>
<span class='line'>16:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>17:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">public&nbsp;function&nbsp;</span><span style="color: #000">__construct</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$type</span><span style="color: #D24; font-weight: bold">)<br>
<span class='line'>18:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>19:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$message&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #080">'The&nbsp;image&nbsp;type&nbsp;%s&nbsp;is&nbsp;not&nbsp;supported,&nbsp;it&nbsp;must&nbsp;be&nbsp;one&nbsp;of&nbsp;Image::JPEG,&nbsp;Image::PNG&nbsp;or&nbsp;Image::GIF.'</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'>20:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">parent</span><span style="color: #D24; font-weight: bold">::</span><span style="color: #000">__construct</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">sprintf</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$message</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">var_export</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$type</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">TRUE</span><span style="color: #D24; font-weight: bold">)));<br>
<span class='line'>21:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>22:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>23:    </span>}<br>
</span></span></code></div>
</div>
	</div>
		<div>
		<table>
		<tr class='light'>
			<td class="number"><small>100 %</small></td>
			<td><div class="bar"><div style="width: 100%"></div></div></td>
			<td><a href="#fragment14" onclick="toggle(this); return false"><span>ImageStore/Exceptions/UploaderException.php</span></a></td>
		</tr>
		</table>

		<div class="code" id="fragment14">
		<div><span class='line'> 1:    </span><code><span style="color: #06B">
<span style="color: #000">&lt;?php<br>
<span class='line'> 2:    </span><br>
<span class='line'> 3:    </span></span><span style="color: #D24; font-weight: bold">namespace&nbsp;</span><span style="color: #000">Rostenkowski</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">ImageStore</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">Exceptions</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'> 4:    </span><br>
<span class='line'> 5:    </span><br>
<span class='line'> 6:    </span>use&nbsp;</span><span style="color: #000">RuntimeException</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'> 7:    </span><br>
<span class='line'> 8:    </span></span><span style="color: #999; font-style: italic">/**<br>
<span class='line'> 9:    </span>&nbsp;*&nbsp;Image&nbsp;upload&nbsp;error&nbsp;exception<br>
<span class='line'>10:    </span>&nbsp;*/<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #999; font-style: italic"><span class='line'>11:    </span></span><span style="color: #D24; font-weight: bold">class&nbsp;</span><span style="color: #000">UploaderException&nbsp;</span><span style="color: #D24; font-weight: bold">extends&nbsp;</span><span style="color: #000">RuntimeException<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #000"><span class='line'>12:    </span></span><span style="color: #D24; font-weight: bold">{<br>
<span class='line'>13:    </span><br>
<span class='line'>14:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>15:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Upload&nbsp;error&nbsp;code&nbsp;-&gt;&nbsp;error&nbsp;message&nbsp;map<br>
<span class='line'>16:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'>17:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@var&nbsp;string[]<br>
<span class='line'>18:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>19:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">private&nbsp;</span><span style="color: #000">$messages&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;[<br>
<span class='line'>20:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">0&nbsp;</span><span style="color: #D24; font-weight: bold">=&gt;&nbsp;</span><span style="color: #080">"There&nbsp;is&nbsp;no&nbsp;error,&nbsp;the&nbsp;file&nbsp;uploaded&nbsp;with&nbsp;success"</span><span style="color: #D24; font-weight: bold">,<br>
<span class='line'>21:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">1&nbsp;</span><span style="color: #D24; font-weight: bold">=&gt;&nbsp;</span><span style="color: #080">"The&nbsp;uploaded&nbsp;file&nbsp;exceeds&nbsp;the&nbsp;upload_max_filesize&nbsp;directive&nbsp;in&nbsp;php.ini"</span><span style="color: #D24; font-weight: bold">,<br>
<span class='line'>22:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">2&nbsp;</span><span style="color: #D24; font-weight: bold">=&gt;&nbsp;</span><span style="color: #080">"The&nbsp;uploaded&nbsp;file&nbsp;exceeds&nbsp;the&nbsp;MAX_FILE_SIZE&nbsp;directive&nbsp;that&nbsp;was&nbsp;specified&nbsp;in&nbsp;the&nbsp;HTML&nbsp;form"</span><span style="color: #D24; font-weight: bold">,<br>
<span class='line'>23:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">3&nbsp;</span><span style="color: #D24; font-weight: bold">=&gt;&nbsp;</span><span style="color: #080">"The&nbsp;uploaded&nbsp;file&nbsp;was&nbsp;only&nbsp;partially&nbsp;uploaded"</span><span style="color: #D24; font-weight: bold">,<br>
<span class='line'>24:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">4&nbsp;</span><span style="color: #D24; font-weight: bold">=&gt;&nbsp;</span><span style="color: #080">"No&nbsp;file&nbsp;was&nbsp;uploaded"</span><span style="color: #D24; font-weight: bold">,<br>
<span class='line'>25:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">6&nbsp;</span><span style="color: #D24; font-weight: bold">=&gt;&nbsp;</span><span style="color: #080">"Missing&nbsp;a&nbsp;temporary&nbsp;folder"</span><span style="color: #D24; font-weight: bold">,<br>
<span class='line'>26:    </span>&nbsp;&nbsp;&nbsp;&nbsp;];<br>
<span class='line'>27:    </span><br>
<span class='line'>28:    </span><br>
<span class='line'>29:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>30:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Constructs&nbsp;the&nbsp;upload&nbsp;error&nbsp;exception&nbsp;using&nbsp;the&nbsp;given&nbsp;upload&nbsp;error&nbsp;code.<br>
<span class='line'>31:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'>32:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;string&nbsp;$code<br>
<span class='line'>33:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>34:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">public&nbsp;function&nbsp;</span><span style="color: #000">__construct</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$code</span><span style="color: #D24; font-weight: bold">)<br>
<span class='line'>35:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>36:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">parent</span><span style="color: #D24; font-weight: bold">::</span><span style="color: #000">__construct</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">messages</span><span style="color: #D24; font-weight: bold">[</span><span style="color: #000">$code</span><span style="color: #D24; font-weight: bold">],&nbsp;</span><span style="color: #000">$code</span><span style="color: #D24; font-weight: bold">);<br>
<span class='line'>37:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>38:    </span><br>
<span class='line'>39:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>40:    </span>}<br>
</span></span></code></div>
</div>
	</div>
		<div>
		<table>
		<tr class='light'>
			<td class="number"><small>100 %</small></td>
			<td><div class="bar"><div style="width: 100%"></div></div></td>
			<td><a href="#fragment15" onclick="toggle(this); return false"><span>ImageStore/Exceptions/DirectoryException.php</span></a></td>
		</tr>
		</table>

		<div class="code" id="fragment15">
		<div><span class='line'> 1:    </span><code><span style="color: #06B">
<span style="color: #000">&lt;?php<br>
<span class='line'> 2:    </span><br>
<span class='line'> 3:    </span></span><span style="color: #D24; font-weight: bold">namespace&nbsp;</span><span style="color: #000">Rostenkowski</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">ImageStore</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">Exceptions</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'> 4:    </span><br>
<span class='line'> 5:    </span><br>
<span class='line'> 6:    </span>use&nbsp;</span><span style="color: #000">InvalidArgumentException</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'> 7:    </span><br>
<span class='line'> 8:    </span></span><span style="color: #999; font-style: italic">/**<br>
<span class='line'> 9:    </span>&nbsp;*&nbsp;Directory&nbsp;exception<br>
<span class='line'>10:    </span>&nbsp;*/<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #999; font-style: italic"><span class='line'>11:    </span></span><span style="color: #D24; font-weight: bold">class&nbsp;</span><span style="color: #000">DirectoryException&nbsp;</span><span style="color: #D24; font-weight: bold">extends&nbsp;</span><span style="color: #000">InvalidArgumentException<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #000"><span class='line'>12:    </span></span><span style="color: #D24; font-weight: bold">{<br>
<span class='line'>13:    </span><br>
<span class='line'>14:    </span><br>
<span class='line'>15:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>16:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;string&nbsp;$directory<br>
<span class='line'>17:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>18:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">public&nbsp;function&nbsp;</span><span style="color: #000">__construct</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$directory</span><span style="color: #D24; font-weight: bold">)<br>
<span class='line'>19:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>20:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">parent</span><span style="color: #D24; font-weight: bold">::</span><span style="color: #000">__construct</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">sprintf</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #080">'Directory&nbsp;"%s"&nbsp;does&nbsp;not&nbsp;exist&nbsp;and&nbsp;cannot&nbsp;be&nbsp;created&nbsp;or&nbsp;it&nbsp;is&nbsp;not&nbsp;writable.'</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">var_export</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$directory</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">TRUE</span><span style="color: #D24; font-weight: bold">)));<br>
<span class='line'>21:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>22:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>23:    </span>}<br>
</span></span></code></div>
</div>
	</div>
		<div>
		<table>
		<tr>
			<td class="number"><small>100 %</small></td>
			<td><div class="bar"><div style="width: 100%"></div></div></td>
			<td><a href="#fragment16" onclick="toggle(this); return false"><span>ImageStore/Requests/ImageRequest.php</span></a></td>
		</tr>
		</table>

		<div class="code" id="fragment16">
		<div><span class='line'>  1:    </span><code><span style="color: #06B">
<span style="color: #000">&lt;?php<br>
<span class='line'>  2:    </span><br>
<span class='line'>  3:    </span></span><span style="color: #D24; font-weight: bold">namespace&nbsp;</span><span style="color: #000">Rostenkowski</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">ImageStore</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">Requests</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'>  4:    </span><br>
<span class='line'>  5:    </span><br>
<span class='line'>  6:    </span>use&nbsp;</span><span style="color: #000">Nette</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">Object</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'>  7:    </span>use&nbsp;</span><span style="color: #000">Nette</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">Utils</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">Image</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'>  8:    </span>use&nbsp;</span><span style="color: #000">Rostenkowski</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">ImageStore</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">Entity</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">EmptyImage</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'>  9:    </span>use&nbsp;</span><span style="color: #000">Rostenkowski</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">ImageStore</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">Meta</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'> 10:    </span>use&nbsp;</span><span style="color: #000">Rostenkowski</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">ImageStore</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">Request</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'> 11:    </span><br>
<span class='line'> 12:    </span></span><span style="color: #999; font-style: italic">/**<br>
<span class='line'> 13:    </span>&nbsp;*&nbsp;Image&nbsp;request&nbsp;encapsulation<br>
<span class='line'> 14:    </span>&nbsp;*/<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #999; font-style: italic"><span class='line'> 15:    </span></span><span style="color: #D24; font-weight: bold">class&nbsp;</span><span style="color: #000">ImageRequest&nbsp;</span><span style="color: #D24; font-weight: bold">extends&nbsp;</span><span style="color: #000">Object&nbsp;</span><span style="color: #D24; font-weight: bold">implements&nbsp;</span><span style="color: #000">Request<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #000"><span class='line'> 16:    </span></span><span style="color: #D24; font-weight: bold">{<br>
<span class='line'> 17:    </span><br>
<span class='line'> 18:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'> 19:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;The&nbsp;requested&nbsp;image&nbsp;meta&nbsp;information.<br>
<span class='line'> 20:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'> 21:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@var&nbsp;Meta<br>
<span class='line'> 22:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'> 23:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">private&nbsp;</span><span style="color: #000">$meta</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'> 24:    </span><br>
<span class='line'> 25:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'> 26:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;The&nbsp;requested&nbsp;image&nbsp;thumbnail&nbsp;dimensions<br>
<span class='line'> 27:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'> 28:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@var&nbsp;string<br>
<span class='line'> 29:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'> 30:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">private&nbsp;</span><span style="color: #000">$dimensions</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'> 31:    </span><br>
<span class='line'> 32:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'> 33:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;The&nbsp;requested&nbsp;image&nbsp;thumbnail&nbsp;flags.<br>
<span class='line'> 34:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'> 35:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@var&nbsp;integer<br>
<span class='line'> 36:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'> 37:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">private&nbsp;</span><span style="color: #000">$flags</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'> 38:    </span><br>
<span class='line'> 39:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'> 40:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;The&nbsp;requested&nbsp;image&nbsp;thumbnail&nbsp;cropping&nbsp;flag.<br>
<span class='line'> 41:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'> 42:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@var&nbsp;boolean<br>
<span class='line'> 43:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'> 44:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">private&nbsp;</span><span style="color: #000">$crop&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">FALSE</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'> 45:    </span><br>
<span class='line'> 46:    </span><br>
<span class='line'> 47:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'> 48:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Constructs&nbsp;the&nbsp;image&nbsp;request&nbsp;from&nbsp;the&nbsp;given&nbsp;meta&nbsp;information,&nbsp;requested&nbsp;dimensions&nbsp;and&nbsp;flags.<br>
<span class='line'> 49:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'> 50:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;Meta&nbsp;&nbsp;&nbsp;&nbsp;$meta<br>
<span class='line'> 51:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;integer&nbsp;$dimensions<br>
<span class='line'> 52:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;integer&nbsp;$flags<br>
<span class='line'> 53:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;boolean&nbsp;$crop<br>
<span class='line'> 54:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'> 55:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">public&nbsp;function&nbsp;</span><span style="color: #000">__construct</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">Meta&nbsp;$meta</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">$dimensions&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">Request</span><span style="color: #D24; font-weight: bold">::</span><span style="color: #000">ORIGINAL</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">$flags&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">Request</span><span style="color: #D24; font-weight: bold">::</span><span style="color: #000">ORIGINAL</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">$crop&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">FALSE</span><span style="color: #D24; font-weight: bold">)<br>
<span class='line'> 56:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'> 57:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">meta&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">$meta</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'> 58:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">dimensions&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">$dimensions</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'> 59:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">flags&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">$flags</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'> 60:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">crop&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">$crop</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'> 61:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'> 62:    </span><br>
<span class='line'> 63:    </span><br>
<span class='line'> 64:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'> 65:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Creates&nbsp;the&nbsp;image&nbsp;request&nbsp;from&nbsp;the&nbsp;crop&nbsp;macro&nbsp;arguments.<br>
<span class='line'> 66:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'> 67:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;Meta&nbsp;&nbsp;$image<br>
<span class='line'> 68:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;array&nbsp;$args<br>
<span class='line'> 69:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;ImageRequest<br>
<span class='line'> 70:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'> 71:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">public&nbsp;static&nbsp;function&nbsp;</span><span style="color: #000">crop</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">Meta&nbsp;$image&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">NULL</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">$args&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;array())<br>
<span class='line'> 72:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'> 73:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span style="color: #000">$image&nbsp;</span><span style="color: #D24; font-weight: bold">===&nbsp;</span><span style="color: #000">NULL</span><span style="color: #D24; font-weight: bold">)&nbsp;{<br>
<span class='line'> 74:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$image&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;new&nbsp;</span><span style="color: #000">EmptyImage</span><span style="color: #D24; font-weight: bold">();<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'> 75:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
<span class='line'> 76:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'> 77:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$dimensions&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;isset(</span><span style="color: #000">$args</span><span style="color: #D24; font-weight: bold">[</span><span style="color: #000">0</span><span style="color: #D24; font-weight: bold">])&nbsp;?&nbsp;</span><span style="color: #000">$args</span><span style="color: #D24; font-weight: bold">[</span><span style="color: #000">0</span><span style="color: #D24; font-weight: bold">]&nbsp;:&nbsp;</span><span style="color: #000">Request</span><span style="color: #D24; font-weight: bold">::</span><span style="color: #000">ORIGINAL</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'> 78:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$flags&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">Image</span><span style="color: #D24; font-weight: bold">::</span><span style="color: #000">FIT</span><span style="color: #D24; font-weight: bold">;<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'> 79:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'> 80:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$request&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;new&nbsp;</span><span style="color: #000">ImageRequest</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$image</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">$dimensions</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">$flags</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">TRUE</span><span style="color: #D24; font-weight: bold">);<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'> 81:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'> 82:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #000">$request</span><span style="color: #D24; font-weight: bold">;<br>
</span></span></code></div>
<div class='dead'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'> 83:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'> 84:    </span><br>
<span class='line'> 85:    </span><br>
<span class='line'> 86:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'> 87:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Creates&nbsp;the&nbsp;image&nbsp;request&nbsp;from&nbsp;the&nbsp;image&nbsp;macro&nbsp;arguments.<br>
<span class='line'> 88:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'> 89:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;Meta&nbsp;&nbsp;$image<br>
<span class='line'> 90:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;array&nbsp;$args<br>
<span class='line'> 91:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;ImageRequest<br>
<span class='line'> 92:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'> 93:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">public&nbsp;static&nbsp;function&nbsp;</span><span style="color: #000">fromMacro</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">Meta&nbsp;$image&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">NULL</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">$args&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;array())<br>
<span class='line'> 94:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'> 95:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span style="color: #000">$image&nbsp;</span><span style="color: #D24; font-weight: bold">===&nbsp;</span><span style="color: #000">NULL</span><span style="color: #D24; font-weight: bold">)&nbsp;{<br>
<span class='line'> 96:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$image&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;new&nbsp;</span><span style="color: #000">EmptyImage</span><span style="color: #D24; font-weight: bold">();<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'> 97:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
<span class='line'> 98:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'> 99:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;</span><span style="color: #000">ImageRequest</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$image</span><span style="color: #D24; font-weight: bold">,&nbsp;isset(</span><span style="color: #000">$args</span><span style="color: #D24; font-weight: bold">[</span><span style="color: #000">0</span><span style="color: #D24; font-weight: bold">])&nbsp;?&nbsp;</span><span style="color: #000">$args</span><span style="color: #D24; font-weight: bold">[</span><span style="color: #000">0</span><span style="color: #D24; font-weight: bold">]&nbsp;:&nbsp;</span><span style="color: #000">Request</span><span style="color: #D24; font-weight: bold">::</span><span style="color: #000">ORIGINAL</span><span style="color: #D24; font-weight: bold">,&nbsp;isset(</span><span style="color: #000">$args</span><span style="color: #D24; font-weight: bold">[</span><span style="color: #000">1</span><span style="color: #D24; font-weight: bold">])&nbsp;?&nbsp;</span><span style="color: #000">$args</span><span style="color: #D24; font-weight: bold">[</span><span style="color: #000">1</span><span style="color: #D24; font-weight: bold">]&nbsp;:&nbsp;</span><span style="color: #000">Request</span><span style="color: #D24; font-weight: bold">::</span><span style="color: #000">ORIGINAL</span><span style="color: #D24; font-weight: bold">);<br>
</span></span></code></div>
<div class='dead'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>100:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>101:    </span><br>
<span class='line'>102:    </span><br>
<span class='line'>103:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>104:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;boolean<br>
<span class='line'>105:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>106:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">public&nbsp;function&nbsp;</span><span style="color: #000">getCrop</span><span style="color: #D24; font-weight: bold">()<br>
<span class='line'>107:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>108:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">crop</span><span style="color: #D24; font-weight: bold">;<br>
</span></span></code></div>
<div class='dead'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>109:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>110:    </span><br>
<span class='line'>111:    </span><br>
<span class='line'>112:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>113:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;Meta<br>
<span class='line'>114:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>115:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">public&nbsp;function&nbsp;</span><span style="color: #000">getMeta</span><span style="color: #D24; font-weight: bold">()<br>
<span class='line'>116:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>117:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">meta</span><span style="color: #D24; font-weight: bold">;<br>
</span></span></code></div>
<div class='dead'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>118:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>119:    </span><br>
<span class='line'>120:    </span><br>
<span class='line'>121:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>122:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;Meta&nbsp;$meta<br>
<span class='line'>123:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;Request<br>
<span class='line'>124:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>125:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">public&nbsp;function&nbsp;</span><span style="color: #000">setMeta</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">Meta&nbsp;$meta</span><span style="color: #D24; font-weight: bold">)<br>
<span class='line'>126:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>127:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">meta&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">$meta</span><span style="color: #D24; font-weight: bold">;<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>128:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>129:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">;<br>
</span></span></code></div>
<div class='dead'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>130:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>131:    </span><br>
<span class='line'>132:    </span><br>
<span class='line'>133:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>134:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;string<br>
<span class='line'>135:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>136:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">public&nbsp;function&nbsp;</span><span style="color: #000">getDimensions</span><span style="color: #D24; font-weight: bold">()<br>
<span class='line'>137:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>138:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">dimensions</span><span style="color: #D24; font-weight: bold">;<br>
</span></span></code></div>
<div class='dead'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>139:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>140:    </span><br>
<span class='line'>141:    </span><br>
<span class='line'>142:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>143:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;integer<br>
<span class='line'>144:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>145:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">public&nbsp;function&nbsp;</span><span style="color: #000">getFlags</span><span style="color: #D24; font-weight: bold">()<br>
<span class='line'>146:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>147:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">flags</span><span style="color: #D24; font-weight: bold">;<br>
</span></span></code></div>
<div class='dead'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>148:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></span></code></div>
<div><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>149:    </span><br>
</span></span></code></div>
<div class='t'><code><span style="color: #06B"><span style="color: #D24; font-weight: bold"><span class='line'>150:    </span>}<br>
</span></span></code></div>
</div>
	</div>
		<div>
		<table>
		<tr class='not-loaded'>
			<td class="number"><small>0 %</small></td>
			<td><div class="bar"><div style="width: 0%"></div></div></td>
			<td><a href="#fragment17" onclick="toggle(this); return false"><span>ImageStore/Extension.php</span></a></td>
		</tr>
		</table>

		<div class="code" id="fragment17">
		<div><span class='line'> 1:    </span><code><span style="color: #06B">
<span style="color: #000">&lt;?php<br>
<span class='line'> 2:    </span><br>
<span class='line'> 3:    </span></span><span style="color: #D24; font-weight: bold">namespace&nbsp;</span><span style="color: #000">Rostenkowski</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">ImageStore</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'> 4:    </span><br>
<span class='line'> 5:    </span><br>
<span class='line'> 6:    </span>use&nbsp;</span><span style="color: #000">Nette</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">DI</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">CompilerExtension</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'> 7:    </span>use&nbsp;</span><span style="color: #000">Nette</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">Utils</span><span style="color: #D24; font-weight: bold">\</span><span style="color: #000">Validators</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'> 8:    </span><br>
<span class='line'> 9:    </span></span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>10:    </span>&nbsp;*&nbsp;The&nbsp;Image&nbsp;Extension<br>
<span class='line'>11:    </span>&nbsp;*/<br>
<span class='line'>12:    </span></span><span style="color: #D24; font-weight: bold">class&nbsp;</span><span style="color: #000">Extension&nbsp;</span><span style="color: #D24; font-weight: bold">extends&nbsp;</span><span style="color: #000">CompilerExtension<br>
<span class='line'>13:    </span></span><span style="color: #D24; font-weight: bold">{<br>
<span class='line'>14:    </span><br>
<span class='line'>15:    </span>&nbsp;&nbsp;&nbsp;&nbsp;protected&nbsp;</span><span style="color: #000">$options&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;[<br>
<span class='line'>16:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #080">'imageEntity'&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">=&gt;&nbsp;</span><span style="color: #080">'Rostenkowski\ImageStore\Entity\ImageEntity'</span><span style="color: #D24; font-weight: bold">,<br>
<span class='line'>17:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #080">'storageClass'&nbsp;</span><span style="color: #D24; font-weight: bold">=&gt;&nbsp;</span><span style="color: #080">'Rostenkowski\ImageStore\ImageStorage'</span><span style="color: #D24; font-weight: bold">,<br>
<span class='line'>18:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #080">'basePath'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">=&gt;&nbsp;</span><span style="color: #080">'/cache/images/'</span><span style="color: #D24; font-weight: bold">,<br>
<span class='line'>19:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #080">'cacheDir'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">=&gt;&nbsp;</span><span style="color: #080">'%baseDir%/www/cache/images'</span><span style="color: #D24; font-weight: bold">,<br>
<span class='line'>20:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #080">'storageDir'&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">=&gt;&nbsp;</span><span style="color: #080">'%baseDir%/storage/images'</span><span style="color: #D24; font-weight: bold">,<br>
<span class='line'>21:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #080">'macros'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">=&gt;&nbsp;[<br>
<span class='line'>22:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #080">'Rostenkowski\ImageStore\Macro\ImageMacro'</span><span style="color: #D24; font-weight: bold">,<br>
<span class='line'>23:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;],<br>
<span class='line'>24:    </span>&nbsp;&nbsp;&nbsp;&nbsp;];<br>
<span class='line'>25:    </span><br>
<span class='line'>26:    </span><br>
<span class='line'>27:    </span>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span style="color: #000">loadConfiguration</span><span style="color: #D24; font-weight: bold">()<br>
<span class='line'>28:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
<span class='line'>29:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">options&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">getConfig</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">options</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">TRUE</span><span style="color: #D24; font-weight: bold">);<br>
<span class='line'>30:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$builder&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">getContainerBuilder</span><span style="color: #D24; font-weight: bold">();<br>
<span class='line'>31:    </span><br>
<span class='line'>32:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">//&nbsp;Image&nbsp;storage<br>
<span class='line'>33:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$builder</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">addDefinition</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">prefix</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #080">'storage'</span><span style="color: #D24; font-weight: bold">))<br>
<span class='line'>34:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;</span><span style="color: #000">setClass</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">options</span><span style="color: #D24; font-weight: bold">[</span><span style="color: #080">'storageClass'</span><span style="color: #D24; font-weight: bold">],&nbsp;[</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">options</span><span style="color: #D24; font-weight: bold">[</span><span style="color: #080">'storageDir'</span><span style="color: #D24; font-weight: bold">],&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">options</span><span style="color: #D24; font-weight: bold">[</span><span style="color: #080">'cacheDir'</span><span style="color: #D24; font-weight: bold">],&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">options</span><span style="color: #D24; font-weight: bold">[</span><span style="color: #080">'basePath'</span><span style="color: #D24; font-weight: bold">]]);<br>
<span class='line'>35:    </span><br>
<span class='line'>36:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">//&nbsp;Latte&nbsp;macros<br>
<span class='line'>37:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">addMacros</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">options</span><span style="color: #D24; font-weight: bold">);<br>
<span class='line'>38:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
<span class='line'>39:    </span><br>
<span class='line'>40:    </span><br>
<span class='line'>41:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999; font-style: italic">/**<br>
<span class='line'>42:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Adds&nbsp;macros&nbsp;(found&nbsp;in&nbsp;$options)&nbsp;to&nbsp;latte&nbsp;factory&nbsp;definition.<br>
<span class='line'>43:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
<span class='line'>44:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;array<br>
<span class='line'>45:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<span class='line'>46:    </span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #D24; font-weight: bold">private&nbsp;function&nbsp;</span><span style="color: #000">addMacros</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$options</span><span style="color: #D24; font-weight: bold">)<br>
<span class='line'>47:    </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br>
<span class='line'>48:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$builder&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">$this</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">getContainerBuilder</span><span style="color: #D24; font-weight: bold">();<br>
<span class='line'>49:    </span><br>
<span class='line'>50:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span style="color: #000">array_key_exists</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #080">'macros'</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #000">$options</span><span style="color: #D24; font-weight: bold">)&nbsp;&amp;&amp;&nbsp;</span><span style="color: #000">is_array</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$options</span><span style="color: #D24; font-weight: bold">[</span><span style="color: #080">'macros'</span><span style="color: #D24; font-weight: bold">]))&nbsp;{<br>
<span class='line'>51:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$factory&nbsp;</span><span style="color: #D24; font-weight: bold">=&nbsp;</span><span style="color: #000">$builder</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">getDefinition</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #080">'nette.latteFactory'</span><span style="color: #D24; font-weight: bold">);<br>
<span class='line'>52:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach&nbsp;(</span><span style="color: #000">$options</span><span style="color: #D24; font-weight: bold">[</span><span style="color: #080">'macros'</span><span style="color: #D24; font-weight: bold">]&nbsp;as&nbsp;</span><span style="color: #000">$macro</span><span style="color: #D24; font-weight: bold">)&nbsp;{<br>
<span class='line'>53:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span style="color: #000">strpos</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$macro</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #080">'::'</span><span style="color: #D24; font-weight: bold">)&nbsp;===&nbsp;</span><span style="color: #000">FALSE&nbsp;</span><span style="color: #D24; font-weight: bold">&amp;&amp;&nbsp;</span><span style="color: #000">class_exists</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$macro</span><span style="color: #D24; font-weight: bold">))&nbsp;{<br>
<span class='line'>54:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$macro&nbsp;</span><span style="color: #D24; font-weight: bold">.=&nbsp;</span><span style="color: #080">'::install'</span><span style="color: #D24; font-weight: bold">;<br>
<span class='line'>55:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br>
<span class='line'>56:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">Validators</span><span style="color: #D24; font-weight: bold">::</span><span style="color: #000">assert</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$macro</span><span style="color: #D24; font-weight: bold">,&nbsp;</span><span style="color: #080">'callable'</span><span style="color: #D24; font-weight: bold">);<br>
<span class='line'>57:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
<span class='line'>58:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000">$factory</span><span style="color: #D24; font-weight: bold">-&gt;</span><span style="color: #000">addSetup</span><span style="color: #D24; font-weight: bold">(</span><span style="color: #000">$macro&nbsp;</span><span style="color: #D24; font-weight: bold">.&nbsp;</span><span style="color: #080">'(?-&gt;getCompiler())'</span><span style="color: #D24; font-weight: bold">,&nbsp;array(</span><span style="color: #080">'@self'</span><span style="color: #D24; font-weight: bold">));<br>
<span class='line'>59:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
<span class='line'>60:    </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
<span class='line'>61:    </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
<span class='line'>62:    </span>}<br>
</span></span></code></div>
</div>
	</div>
	
	<footer>
		<p>Generated by <a href="https://tester.nette.org">Nette Tester</a> at 2016/07/12 20:24:05</p>
	</footer>

	<script>
	function toggle(link) {
		var el = document.getElementById(link.href.split('#')[1]);
		if (el.style.display === 'block') {
			el.style.display = 'none';
			return false;
		} else {
			el.style.display = 'block';
		}
	}
	</script>
</body>
</html>
